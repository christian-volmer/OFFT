(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    194851,       5039]
NotebookOptionsPosition[    178601,       4758]
NotebookOutlinePosition[    179001,       4774]
CellTagsIndexPosition[    178958,       4771]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$CheckSimplifications", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Fourier", ",", "InverseFourier", ",", "FourierMatrix"}], "}"}], 
    ",", 
    RowBox[{"FourierParameters", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b6564691-30d1-4fc3-9aa5-560766b07003"],

Cell[CellGroupData[{

Cell["Misc", "Section",ExpressionUUID->"d60adde2-62e7-4614-ac4b-cbc6159de9ac"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "DirectSum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirectSum", "[", "m__", "]"}], "/;", 
    RowBox[{"And", "@@", 
     RowBox[{"(", 
      RowBox[{"MatrixQ", "/@", 
       RowBox[{"{", "m", "}"}]}], ")"}]}]}], ":=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"ReleaseHold", "[", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Hold", "/@", 
       RowBox[{"{", "m", "}"}]}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"f51983fa-e17b-4809-bee8-0b31f41a702e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "IdentityMatrixQ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentityMatrixQ", "[", "m_", "]"}], ":=", 
   RowBox[{"TrueQ", "[", 
    RowBox[{
     RowBox[{"MatrixQ", "[", "m", "]"}], "&&", 
     RowBox[{"Equal", "@@", 
      RowBox[{"Dimensions", "[", "m", "]"}]}], "&&", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "m", "]"}], "]"}], "\[Equal]", "m"}]}], "]"}]}],
   ";"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"90034c71-3dc1-44f2-b432-2a05e42b790f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "OperationCount", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperationCount", "[", 
     RowBox[{"m_", "/;", 
      RowBox[{"MatrixQ", "[", "m", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"additions", ",", "multiplications"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"additions", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiplications", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Count", " ", "operations", " ", "required", " ", "per", " ", 
         "matrix", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PossibleZeroQ", "[", "#", "]"}], ",", "Null", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"#", "-", "1"}], "]"}], "||", 
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"#", "+", "1"}], "]"}], "||", 
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"#", "-", "I"}], "]"}], "||", 
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"#", "+", "I"}], "]"}]}], ",", "Null", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"Im", "[", "#", "]"}], "]"}], "||", 
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{"Re", "[", "#", "]"}], "]"}]}], ",", 
             RowBox[{"multiplications", "+=", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{
                RowBox[{"Im", "[", "#", "]"}], "-", 
                RowBox[{"Re", "[", "#", "]"}]}], "]"}], "||", 
              RowBox[{"PossibleZeroQ", "[", 
               RowBox[{
                RowBox[{"Im", "[", "#", "]"}], "+", 
                RowBox[{"Re", "[", "#", "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"multiplications", "+=", "2"}], ";", 
              RowBox[{"additions", "+=", "2"}]}], ",", "\[IndentingNewLine]", 
             "True", ",", 
             RowBox[{
              RowBox[{"multiplications", "+=", "4"}], ";", 
              RowBox[{"additions", "+=", "2"}]}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "m", ",", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"additions", "+=", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Max", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "!=", "0"}], "&"}], ")"}]}]}], "]"}], "-", 
               "1"}]}], "]"}]}], "&"}], "/@", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"additions", ",", "multiplications"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperationCount", "[", 
     RowBox[{"tl_", "/;", 
      RowBox[{"TransformationListQ", "[", "tl", "]"}]}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"OperationCount", "/@", 
      RowBox[{"List", "@@", "tl"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperationCount", "[", 
     RowBox[{"blf_", "/;", 
      RowBox[{"BilinearFormQ", "[", "blf", "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"OperationCount", "[", 
      RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}], "]"}], "+", 
     RowBox[{"OperationCount", "[", 
      RowBox[{
       RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], 
       "\[Transpose]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], "*", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{
         RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OperationCost", "[", "arg_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"additions", ",", "multiplications"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"additions", ",", "multiplications"}], "}"}], "=", 
       RowBox[{"OperationCount", "[", "arg", "]"}]}], ";", 
      RowBox[{"additions", "+", "multiplications"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"b9caa872-1545-48d8-8e81-b93d400d01e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["TransformationList", "Section",ExpressionUUID->"4987bf19-9263-4ba4-8fdf-4a5e7fd10fd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "TransformationList", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "TransformationList", "]"}], ";"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"5f290568-cece-4d43-bea7-f23b6a0e579f"],

Cell[CellGroupData[{

Cell["TransformationListQ", "Subsection",ExpressionUUID->"51151581-3d18-4ed5-b7cd-f6ecbb56bc87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "TransformationListQ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformationListQ", "[", 
    RowBox[{"TransformationList", "[", 
     RowBox[{"transformations", ":", 
      RowBox[{
       RowBox[{"_", "?", "MatrixQ"}], ".."}]}], "]"}], "]"}], ":=", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"Equal", "@@@", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Dimensions", "/@", 
           RowBox[{"{", "transformations", "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", "2"}], 
       "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformationListQ", "[", "_", "]"}], ":=", "False"}], 
  ";"}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"5a3eaf7a-269d-4bec-b75c-5053edeb870b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Normal", "Subsection",ExpressionUUID->"3f97a7d6-c46c-4aba-bc53-4a4f4f338cd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformationList", "/:", 
   RowBox[{"Normal", "[", 
    RowBox[{
     RowBox[{"TransformationList", "[", "transformations__", "]"}], "/;", 
     RowBox[{"TransformationListQ", "[", 
      RowBox[{"TransformationList", "[", "transformations", "]"}], "]"}]}], 
    "]"}], ":=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"{", "transformations", "}"}]}]}], ";"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"ef79aeaa-4273-49c5-97fb-a96ff7ea416f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transpose", "Subsection",ExpressionUUID->"c1dd2725-d360-4de7-89cf-7c9cf5349451"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformationList", "/:", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"TransformationList", "[", "transformations__", "]"}], "/;", 
     RowBox[{"TransformationListQ", "[", 
      RowBox[{"TransformationList", "[", "transformations", "]"}], "]"}]}], 
    "]"}], ":=", 
   RowBox[{"TransformationList", "@@", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Transpose", "/@", 
      RowBox[{"{", "transformations", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"419eff5f-d604-45e3-a7b7-8fe40f7fd6b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dimensions", "Subsection",ExpressionUUID->"9eab1af3-e85a-445c-a339-13d51b2a5bbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformationList", "/:", "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", 
    RowBox[{
     RowBox[{"TransformationList", "[", "transformations__", "]"}], "/;", 
     RowBox[{"TransformationListQ", "[", 
      RowBox[{"TransformationList", "[", "transformations", "]"}], "]"}]}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{"First", "[", 
        RowBox[{"{", "transformations", "}"}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{"Last", "[", 
        RowBox[{"{", "transformations", "}"}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"70f399fb-63e9-45c8-b687-7c2628328de5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Format", "Subsection",ExpressionUUID->"a7780326-5938-4079-baa1-758de17eb9db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"transformations_TransformationList", "/;", 
     RowBox[{"TransformationListQ", "[", "transformations", "]"}]}], "]"}], ":=", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"List", "@@", "transformations"}]}]}], ";"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"7d4a91c6-cca2-4beb-8b7b-e9f76dfb13a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["DirectSum", "Subsection",ExpressionUUID->"93042c2a-c48d-4352-b5ab-9c59f635d30b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DirectSum", "::", "tllen"}], "=", 
   "\"\<The lengths of all TransformationList objects must be the \
same.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirectSum", "[", "m__TransformationList", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"TransformationList", "@@", 
      RowBox[{"(", 
       RowBox[{"DirectSum", "@@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"List", "@@@", 
          RowBox[{"{", "m", "}"}]}], "]"}]}], ")"}]}], ")"}], "/;", 
    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"SameQ", "@@", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", 
            RowBox[{"{", "m", "}"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"DirectSum", "::", "tllen"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "True"}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"394e9831-c22a-417f-bbc5-b6cb61744ea4"]
}, Closed]],

Cell[CellGroupData[{

Cell["KroneckerProduct", "Subsection",ExpressionUUID->"c99bc931-d77f-471e-95f6-d78ee71e2a0f"],

Cell["\<\
KroneckerProduct satisfies the mixed product property (a\[TensorProduct]b).(c\
\[TensorProduct]d)==(a.c)\[TensorProduct](b.d): \
\>", "Text",ExpressionUUID->"f0e191d7-4058-4ab8-b0ca-d61084625dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformationList", "/:", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"TransformationList", "[", "a__", "]"}], ",", 
     RowBox[{"TransformationList", "[", "b__", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "aa", ",", "bb", ",", "totalLength", ",", "\[IndentingNewLine]", "aa1", 
       ",", "bb1", ",", "cc1", ",", "\[IndentingNewLine]", "aa2", ",", "bb2", 
       ",", "cc2", ",", "\[IndentingNewLine]", "cc"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aa", "=", 
       RowBox[{"List", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bb", "=", 
       RowBox[{"List", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"totalLength", "=", 
       RowBox[{
        RowBox[{"Length", "[", "aa", "]"}], "+", 
        RowBox[{"Length", "[", "bb", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "There", " ", "are", " ", "two", " ", "ways", " ", "to", " ", 
        "compute", " ", "the", " ", "Kronecker", " ", "product", " ", "that", 
        " ", "differ", " ", "in", " ", "the"}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "order", " ", "of", " ", "the", " ", "padding", " ", "with", " ", 
        "identity", " ", 
        RowBox[{"matrices", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "compute", " ", "both", " ", "and", " ", "choose", " ", 
        "the", " ", "result", " ", "with", " ", "lower", " ", "computational",
         " ", 
        RowBox[{"cost", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"aa1", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"aa", ",", "totalLength", ",", 
         RowBox[{"{", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Last", "[", "aa", "]"}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bb1", "=", 
       RowBox[{"PadLeft", "[", 
        RowBox[{"bb", ",", "totalLength", ",", 
         RowBox[{"{", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"First", "[", "bb", "]"}], "]"}], "\[LeftDoubleBracket]",
             "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cc1", "=", 
       RowBox[{"TransformationList", "@@", 
        RowBox[{"(", 
         RowBox[{"KroneckerProduct", "@@@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"aa1", ",", "bb1"}], "}"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"aa2", "=", 
       RowBox[{"PadLeft", "[", 
        RowBox[{"aa", ",", "totalLength", ",", 
         RowBox[{"{", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"First", "[", "aa", "]"}], "]"}], "\[LeftDoubleBracket]",
             "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bb2", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"bb", ",", "totalLength", ",", 
         RowBox[{"{", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Last", "[", "bb", "]"}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cc2", "=", 
       RowBox[{"TransformationList", "@@", 
        RowBox[{"(", 
         RowBox[{"KroneckerProduct", "@@@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"aa2", ",", "bb2"}], "}"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cc", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OperationCost", "[", "cc1", "]"}], "<", 
          RowBox[{"OperationCost", "[", "cc2", "]"}]}], ",", "cc1", ",", 
         "cc2"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cc", "/;", 
       RowBox[{
        RowBox[{"TransformationListQ", "[", 
         RowBox[{"TransformationList", "[", "a", "]"}], "]"}], "&&", 
        RowBox[{"TransformationListQ", "[", 
         RowBox[{"TransformationList", "[", "b", "]"}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"380c8e16-d739-45a0-a1c3-59fef16baf86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Protect", "Subsection",ExpressionUUID->"f0e749a0-2bbb-41bf-ae3f-9627baa7c7e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "TransformationList", "]"}], ";"}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"8fa82d12-8e64-4b82-8740-1e7dc9f0b884"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["BilinearForm", "Section",ExpressionUUID->"50c88980-947d-4cc1-875f-48a83b033ff6"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "BilinearForm", "]"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"d9f4b3f1-8796-47ff-a492-b308e0ce9529"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BilinearForm", "::", "valid"}], "=", 
   "\"\<The given object does not represent a valid or consistent bilinear \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearForm", "::", "property"}], "=", 
   "\"\<The BilinearForm object does not have propery \\\"`1`\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearForm", "::", "input"}], "=", 
   "\"\<The length of the input vector does not match the dimensions of the \
input transformation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearForm", "::", "kernel"}], "=", 
   "\"\<The length of the kernel vector does not match the dimensions of the \
input transformation.\>\""}], ";"}]}], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"d53d0dfb-7e33-4e01-8bfe-05e049d09487"],

Cell[CellGroupData[{

Cell["BilinearFormQ", "Subsection",ExpressionUUID->"8827e60c-f515-44dd-97cd-3f1430b501c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "BilinearFormQ", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BilinearFormQ", "[", 
     RowBox[{"blf", ":", 
      RowBox[{"BilinearForm", "[", "data_List", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "inputTransform", ",", "outputTransform", ",", "kernelTransform", ",", 
        "kernelLength"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], "=!=", "3"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Head", "/@", "data"}], ",", 
            RowBox[{"{", "Rule", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "Rule", "}"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "/@", "data"}], "=!=", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"inputTransform", "=", 
        RowBox[{"\"\<InputTransformation\>\"", "/.", "data"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"TransformationListQ", "[", "inputTransform", "]"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outputTransform", "=", 
        RowBox[{"\"\<OutputTransformation\>\"", "/.", "data"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"TransformationListQ", "[", "outputTransform", "]"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"kernelTransform", "=", 
        RowBox[{"\"\<KernelTransformation\>\"", "/.", "data"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"TransformationListQ", "[", "kernelTransform", "]"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"kernelLength", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Dimensions", "[", "kernelTransform", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "inputTransform", "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
         "kernelLength"}], "\[IndentingNewLine]", "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "outputTransform", "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "==", 
         "kernelLength"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearFormQ", "[", "_", "]"}], ":=", "False"}], ";"}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"a200f0c2-9c16-40fc-af68-a162cb8a0032"]
}, Closed]],

Cell[CellGroupData[{

Cell["BilinearForm[][\[OpenCurlyDoubleQuote]property\[CloseCurlyDoubleQuote]]\
", "Subsection",ExpressionUUID->"37452684-5221-4518-b96e-9de71245a9c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BilinearForm", "[", "data_List", "]"}], "[", "property_String", 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"blf", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"result", "/;", 
      RowBox[{"Catch", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"blf", "=", 
         RowBox[{"BilinearForm", "[", "data", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"BilinearFormQ", "[", "blf", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"BilinearForm", "::", "valid"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"property", "/.", "data"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"result", "===", "property"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"BilinearForm", "::", "property"}], ",", "property"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Throw", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "True"}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"41fb8cb0-2662-4419-9be9-814cb11ac801"]
}, Closed]],

Cell[CellGroupData[{

Cell["BilinearForm[][vector]", "Subsection",ExpressionUUID->"ae5d3d86-040a-498e-936a-5c78cdc2364e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BilinearForm", "[", "data_List", "]"}], "[", 
    RowBox[{"v_List", "?", "VectorQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"blf", ",", "result", ",", "kernelTransform"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "/;", 
      RowBox[{"Catch", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"blf", "=", 
         RowBox[{"BilinearForm", "[", "data", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"BilinearFormQ", "[", "blf", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"BilinearForm", "::", "valid"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"kernelTransform", "=", 
         RowBox[{"blf", "[", "\"\<KernelTransformation\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "kernelTransform", "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=!=", 
           RowBox[{"Length", "[", "v", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"BilinearForm", "::", "kernel"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"TransformationList", "[", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "kernelTransform", "]"}], ".", "v"}], 
             "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "True"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"fa792788-2df2-45f7-b293-0306a7b0df58"]
}, Closed]],

Cell[CellGroupData[{

Cell["BilinearFormLengths", "Subsection",ExpressionUUID->"7aaf6a3c-f35e-455f-9a0e-8d6cad0d1145"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "BilinearFormLengths", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearFormLengths", "[", "blf_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inputLength", ",", "outputLength", ",", "kernelLength"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kernelLength", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"blf", "[", "\"\<KernelTransformation\>\"", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inputLength", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"outputLength", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kernelLength", ",", "inputLength", ",", "outputLength"}], 
        "}"}], "/;", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"BilinearFormQ", "[", "blf", "]"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"BilinearForm", "::", "valid"}], "]"}], ";", "False"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"c38483ab-9d02-45b5-acfa-77e2b7025d6f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convolution", "Section",ExpressionUUID->"5a3c1f13-c2dd-4e54-b9c8-fd04938979e0"],

Cell[CellGroupData[{

Cell["PolynomialFunctionQ", "Subsection",ExpressionUUID->"8c599624-04d2-4733-8d29-dca5b3f8b80e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolynomialFunctionQ", "[", "poly_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"PolynomialQ", "[", 
      RowBox[{
       RowBox[{"poly", "[", "x", "]"}], ",", "x"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"3c8b1a3c-e5d3-4857-aaf2-d0da1e721632"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinearConvolutionMatrix", "Subsection",ExpressionUUID->"c7d2fd2d-b5a9-4566-9a9b-03816ff423b4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "LinearConvolutionMatrix", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearConvolutionMatrix", "::", "kernel"}], "=", 
   "\"\<The kernel `1` is not a vector.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LinearConvolutionMatrix", "::", "length"}], "=", 
    "\"\<The input length `1` must be an integer greater than zero.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearConvolutionMatrix", "[", 
    RowBox[{"kernel_", ",", "inputLength_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ToeplitzMatrix", "[", 
     RowBox[{
      RowBox[{"PadRight", "[", 
       RowBox[{"kernel", ",", 
        RowBox[{"inputLength", "+", 
         RowBox[{"Length", "[", "kernel", "]"}], "-", "1"}]}], "]"}], ",", 
      RowBox[{"PadRight", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"First", "[", "kernel", "]"}], "}"}], ",", "inputLength"}], 
       "]"}]}], "]"}], "/;", 
    RowBox[{"Catch", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "kernel", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LinearConvolutionMatrix", "::", "kernel"}], ",", 
           "kernel"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "inputLength", "]"}], "&&", 
           RowBox[{"inputLength", ">", "0"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LinearConvolutionMatrix", "::", "length"}], ",", 
           "inputLength"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "True"}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"42255f0a-16b8-44ff-9a8d-b520c2333600"]
}, Closed]],

Cell[CellGroupData[{

Cell["ModularReduction", "Subsection",ExpressionUUID->"43fff485-00b7-452b-9c1d-229b482d2f2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ModularReduction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModularReduction", "::", "modulus"}], "=", 
   "\"\<The modulus `1` is not a function that evaluates to a polynomial in \
the parameter.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModularReduction", "::", "length"}], "=", 
    "\"\<The input length `1` must be an integer greater than zero.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModularReduction", "[", 
    RowBox[{"modulus_", ",", "inputLength_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", "coeffs", ",", "numberOfSteps", ",", "baseReductionMatrix", 
       ",", "i"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeffs", "=", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{"modulus", "[", "x", "]"}], ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{"-", 
        RowBox[{"Most", "[", 
         RowBox[{"coeffs", "/", 
          RowBox[{"Last", "[", "coeffs", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"numberOfSteps", "=", 
       RowBox[{"inputLength", "-", 
        RowBox[{"Length", "[", "coeffs", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numberOfSteps", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coeffs", "=", 
           RowBox[{"PadLeft", "[", 
            RowBox[{"coeffs", ",", 
             RowBox[{"inputLength", "-", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"baseReductionMatrix", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"inputLength", "-", "1"}], "]"}], ",", "coeffs"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"TransformationList", "@@", 
           RowBox[{"Reverse", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"baseReductionMatrix", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"i", ";;"}], ",", 
                RowBox[{"i", ";;"}]}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "numberOfSteps"}], "}"}]}], "]"}], "]"}]}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"TransformationList", "[", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "coeffs", "]"}], ",", "inputLength"}], 
            "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{"Catch", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"PolynomialFunctionQ", "[", "modulus", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"ModularReduction", "::", "modulus"}], ",", "modulus"}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IntegerQ", "[", "inputLength", "]"}], "&&", 
              RowBox[{"inputLength", ">", "0"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"ModularReduction", "::", "length"}], ",", 
              "inputLength"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "True"}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"e979a5de-385a-4254-889b-a966976f9987"]
}, Closed]],

Cell[CellGroupData[{

Cell["WinogradModularConvolution", "Subsection",ExpressionUUID->"30103d7c-b2dd-4297-85ba-820bb6b8c5bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WinogradModularConvolution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "winogradModularConvolution", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WinogradModularConvolution", "::", "specification"}], "=", 
   "\"\<The first parameter must be a list of lists of a polynomial function \
and a BilinearForm of an appropriate convolution.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WinogradModularConvolution", "::", "factor"}], "=", 
   "\"\<`1` is not a function that is a polynomial in its parameter.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WinogradModularConvolution", "::", "bilinear"}], "=", 
    "\"\<`1` is not a BilinearForm object in untransformed kernel form that \
represents a convolution with kernel and input length of `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"winogradParseFactorSpecification", "[", "specification_", "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "factors", ",", "convolutions", ",", "convolutionLengths", ",", 
        "factorLength", ",", "x", ",", "factorsX", ",", "modulus", ",", 
        "factors2", ",", "inverses", ",", "reconstructions"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"specification", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"WinogradModularConvolution", "::", "specification"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"factors", "=", 
        RowBox[{"specification", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"convolutions", "=", 
        RowBox[{"specification", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"convolutionLengths", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", 
          RowBox[{"Length", "[", "specification", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"PolynomialFunctionQ", "[", 
             RowBox[{
             "factors", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"WinogradModularConvolution", "::", "factor"}], ",", 
              RowBox[{
              "factors", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "factors", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"factorLength", "=", 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "factors", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "[", "x", "]"}], ",", "x"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"BilinearFormQ", "[", 
                RowBox[{
                "convolutions", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "]"}], "\[IndentingNewLine]", "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "convolutionLengths", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"BilinearFormLengths", "[", 
                   RowBox[{
                   "convolutions", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{
                   "convolutionLengths", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}], "===", "3"}]}], ")"}], 
               "\[IndentingNewLine]", "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"convolutionLengths", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "==", 
                 "factorLength"}], ")"}], "\[IndentingNewLine]", "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"convolutionLengths", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "==", 
                 "factorLength"}], ")"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"WinogradModularConvolution", "::", "bilinear"}], ",", 
               RowBox[{
               "convolutions", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "factorLength"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "factors", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"factorsX", "=", 
        RowBox[{"Through", "[", 
         RowBox[{"factors", "[", "x", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"modulus", "=", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Times", "@@", "factorsX"}], "]"}], "/.", 
           RowBox[{"x", "->", "#"}]}], "]"}], "&"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"factors2", "=", 
        RowBox[{"Together", "[", 
         RowBox[{
          RowBox[{"modulus", "[", "x", "]"}], "/", "factorsX"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"inverses", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"PolynomialExtendedGCD", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
              "x"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"factors2", ",", "factorsX"}], "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reconstructions", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolynomialMod", "[", 
            RowBox[{"#", ",", 
             RowBox[{"modulus", "[", "x", "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"factors2", "*", "inverses"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reconstructions", "=", 
        RowBox[{"reconstructions", "/.", 
         RowBox[{"x", "->", "#"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"reconstructions", "=", 
        RowBox[{"Function", "/@", "reconstructions"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"modulus", ",", "factors", ",", "reconstructions"}], "}"}], 
         ",", "convolutions"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"winogradModularConvolution", "[", 
     RowBox[{"specification_", ",", "kernelLength_", ",", "inputLength_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "modulus", ",", "factors", ",", "reconstructions", ",", "convolutions",
         ",", "\[IndentingNewLine]", "x", ",", "i", ",", "commonLength", ",", 
        "\[IndentingNewLine]", "kernelReductions", ",", "inputReductions", 
        ",", "\[IndentingNewLine]", "kernelTransformations", ",", 
        "inputTransformations", ",", "outputTransformations", ",", 
        "\[IndentingNewLine]", "outputReconstructions", ",", 
        "outputReductions"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"modulus", ",", "factors", ",", "reconstructions"}], "}"}],
           ",", "convolutions"}], "}"}], "=", "specification"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"REDUCTION", " ", 
         RowBox[{"PHASE", " ", "--"}], " ", "input", " ", "and", " ", 
         "kernel"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kernelReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ModularReduction", "[", 
           RowBox[{"#", ",", "kernelLength"}], "]"}], "&"}], "/@", 
         "factors"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "kernelReductions"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kernelReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "kernelReductions"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"inputReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ModularReduction", "[", 
           RowBox[{"#", ",", "inputLength"}], "]"}], "&"}], "/@", 
         "factors"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "inputReductions"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inputReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "inputReductions"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"CONVOLUTION", " ", 
          RowBox[{"PHASE", " ", "--"}], " ", "transformations", " ", "of", 
          " ", "input"}], ",", " ", 
         RowBox[{"kernel", " ", "and", " ", "output"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"kernelTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<KernelTransformation\>\"", "]"}], "&"}], "/@",
          "convolutions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "kernelTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kernelTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "kernelTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"inputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<InputTransformation\>\"", "]"}], "&"}], "/@",
          "convolutions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "inputTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "inputTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"outputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"#", "[", "\"\<OutputTransformation\>\"", "]"}], "]"}], 
          "&"}], "/@", "convolutions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "outputTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "outputTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"RECONSTRUCTION", " ", "PHASE"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outputReconstructions", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LinearConvolutionMatrix", "[", 
           RowBox[{
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "reconstructions", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "[", "x", "]"}], ",", "x"}], "]"}],
             ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{
              "outputTransformations", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "factors", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outputReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ModularReduction", "[", 
           RowBox[{"modulus", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
         "outputReconstructions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "outputReductions"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outputReductions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "outputReductions"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"outputReconstructions", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{
            "outputReductions", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "outputReconstructions", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "factors", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"kernelTransformations", "=", 
        RowBox[{"Join", "@@@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"kernelTransformations", ",", "kernelReductions"}], "}"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"inputTransformations", "=", 
        RowBox[{"Join", "@@@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"inputTransformations", ",", "inputReductions"}], "}"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputTransformations", "=", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", 
          RowBox[{"Join", "@@@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"outputReconstructions", ",", "outputTransformations"}], 
             "}"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BilinearForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<InputTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "inputTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "inputTransformations"}], ")"}]}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<KernelTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "kernelTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "kernelTransformations"}], ")"}]}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<OutputTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "outputTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "outputTransformations"}], ")"}]}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WinogradModularConvolution", "[", 
    RowBox[{"specification_", ",", "kernelLength_", ",", "inputLength_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SimplifyBilinearForm", "[", "result", "]"}], "/;", 
      RowBox[{"Catch", "[", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"winogradModularConvolution", "[", 
          RowBox[{
           RowBox[{
           "winogradParseFactorSpecification", "[", "specification", "]"}], 
           ",", "kernelLength", ",", "inputLength"}], "]"}]}], ";", "True"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"39bb59e4-4ecd-4105-a6f3-18b51f8ddf6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["WinogradLinearConvolution", "Subsection",ExpressionUUID->"238d8756-98ae-4c50-b877-7199ac76c891"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WinogradLinearConvolution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WinogradLinearConvolution", "::", "length"}], "=", 
    "\"\<The degree of the modulus must be `1`, which is the total of the \
lengths of the kernel and the input minus two.\>\""}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"winogradLinearConvolution", "[", 
     RowBox[{"specification_", ",", "kernelLength_", ",", "inputLength_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "modulus", ",", "factors", ",", "reconstructions", ",", "convolutions",
         ",", "\[IndentingNewLine]", "x", ",", "\[IndentingNewLine]", 
        "baseConvolution", ",", "convolutionLength", ",", "commonLength", ",",
         "inputTransformations", ",", "kernelTransformations", ",", 
        "outputBaseTransformation", ",", "outputTransformations"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"modulus", ",", "factors", ",", "reconstructions"}], "}"}],
           ",", "convolutions"}], "}"}], "=", "specification"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"baseConvolution", "=", 
        RowBox[{"winogradModularConvolution", "[", 
         RowBox[{"specification", ",", "kernelLength", ",", "inputLength"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"convolutionLength", "=", 
        RowBox[{"kernelLength", "+", "inputLength", "-", "1"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outputBaseTransformation", "=", 
        RowBox[{
        "baseConvolution", "[", "\"\<OutputTransformation\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "outputBaseTransformation", "]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=!=", 
          RowBox[{"convolutionLength", "-", "1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"WinogradLinearConvolution", "::", "length"}], ",", 
            RowBox[{"kernelLength", "+", "inputLength", "-", "2"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kernelTransformations", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "baseConvolution", "[", "\"\<KernelTransformation\>\"", "]"}], ",", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"{", 
            RowBox[{"UnitVector", "[", 
             RowBox[{"kernelLength", ",", "kernelLength"}], "]"}], "}"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "kernelTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kernelTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "kernelTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"inputTransformations", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "baseConvolution", "[", "\"\<InputTransformation\>\"", "]"}], ",", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"{", 
            RowBox[{"UnitVector", "[", 
             RowBox[{"inputLength", ",", "inputLength"}], "]"}], "}"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "inputTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "inputTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputBaseTransformation", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{"#", ",", "convolutionLength"}], "]"}], "&"}], "/@", 
         RowBox[{"outputBaseTransformation", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outputTransformations", "=", 
        RowBox[{"{", 
         RowBox[{"outputBaseTransformation", ",", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"{", 
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"modulus", "[", "x", "]"}], ",", "x"}], "]"}], "}"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"commonLength", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Length", "/@", "outputTransformations"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outputTransformations", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{"#", ",", "commonLength", ",", 
            RowBox[{"{", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "\[LeftDoubleBracket]", 
               "1", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}], "&"}], "/@",
          "outputTransformations"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BilinearForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<InputTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "inputTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "inputTransformations"}], ")"}]}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<KernelTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "kernelTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "kernelTransformations"}], ")"}]}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<OutputTransformation\>\"", "->", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DirectSum", "@@", 
              RowBox[{"(", 
               RowBox[{"Most", "/@", "outputTransformations"}], ")"}]}], ",", 
             RowBox[{"Join", "@@", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "outputTransformations"}], ")"}]}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WinogradLinearConvolution", "[", 
    RowBox[{"specification_", ",", "kernelLength_", ",", "inputLength_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SimplifyBilinearForm", "[", "result", "]"}], "/;", 
      RowBox[{"Catch", "[", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"winogradLinearConvolution", "[", 
          RowBox[{
           RowBox[{
           "winogradParseFactorSpecification", "[", "specification", "]"}], 
           ",", "kernelLength", ",", "inputLength"}], "]"}]}], ";", "True"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"523500f0-a1ed-4b01-82b7-34e79c9cd463"]
}, Closed]],

Cell[CellGroupData[{

Cell["IteratedConvolution", "Subsection",ExpressionUUID->"81e180d2-b45a-46d1-b223-3b11a8d0f45d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"IteratedConvolution", ",", "iteratedConvolution"}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"iteratedConvolution", "[", 
     RowBox[{
     "primaryConvolution_", ",", "secondaryConvolution_", ",", "overlap_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "it", ",", "kt", ",", "ot", ",", "\[IndentingNewLine]", 
        "primaryResultLength", ",", "\[IndentingNewLine]", 
        "partialResultsLength", ",", "\[IndentingNewLine]", "rawLength", ",", 
        "targetLength", ",", "\[IndentingNewLine]", "p", ",", 
        "combinationMatrix"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"it", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{
          "primaryConvolution", "[", "\"\<InputTransformation\>\"", "]"}], 
          ",", 
          RowBox[{
          "secondaryConvolution", "[", "\"\<InputTransformation\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kt", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{
          "primaryConvolution", "[", "\"\<KernelTransformation\>\"", "]"}], 
          ",", 
          RowBox[{
          "secondaryConvolution", "[", "\"\<KernelTransformation\>\"", 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ot", "=", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{
          "primaryConvolution", "[", "\"\<OutputTransformation\>\"", "]"}], 
          ",", 
          RowBox[{
          "secondaryConvolution", "[", "\"\<OutputTransformation\>\"", 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"primaryResultLength", "=", 
        RowBox[{
         RowBox[{"BilinearFormLengths", "[", "primaryConvolution", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"partialResultsLength", "=", 
        RowBox[{
         RowBox[{"BilinearFormLengths", "[", "secondaryConvolution", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rawLength", "=", 
        RowBox[{"primaryResultLength", "\[Times]", "partialResultsLength"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"targetLength", "=", 
        RowBox[{
         RowBox[{"primaryResultLength", "\[Times]", "partialResultsLength"}], 
         "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"primaryResultLength", "-", "1"}], ")"}], "\[Times]", 
          "overlap"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"combinationMatrix", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"combinationMatrix", ",", 
               RowBox[{"UnitVector", "[", 
                RowBox[{"targetLength", ",", "p"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"++", "p"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "partialResultsLength", "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"p", "-=", "overlap"}]}], ",", 
         RowBox[{"{", "primaryResultLength", "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ot", ",", "combinationMatrix"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"BilinearForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<InputTransformation\>\"", "->", "it"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<OutputTransformation\>\"", "->", "ot"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<KernelTransformation\>\"", "->", "kt"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IteratedConvolution", "[", 
    RowBox[{
    "primaryConvolution_", ",", "secondaryConvolution_", ",", "overlap_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"result", "/;", 
      RowBox[{"Catch", "[", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"iteratedConvolution", "[", 
          RowBox[{
          "primaryConvolution", ",", "secondaryConvolution", ",", "overlap"}],
           "]"}]}], ";", "True"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"8c33f2a8-4abd-49fe-be3a-8a0c5bbd2a0b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplification", "Section",ExpressionUUID->"2f48bbe5-8fbc-4e5d-a865-9fb8514de3a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RowOrderingFunction", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "!=", "0"}], "&"}], ")"}]}]}], "]"}], "==", 
         RowBox[{"!", "1"}]}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "!=", "0"}], "&"}], ")"}]}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Abs", "[", "#", "]"}], "]"}], ",", "#"}], "}"}], "&"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RowOrderingFunction", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "!=", "0"}], "&"}], ")"}]}]}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Abs", "[", "#", "]"}], "]"}], ",", "#"}], "}"}], "&"}]}], 
   ";"}]}]], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"6eefe012-c2aa-472f-bc52-92743bdecb17"],

Cell[CellGroupData[{

Cell["AutoCombineRows", "Subsection",ExpressionUUID->"2bed9d3d-c390-410e-b373-c39817c0deac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AutoCombineRows", "[", "m_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "rowScalings", ",", "rowSigns", ",", "rowCombinations", ",", 
       "scaledM"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rowScalings", "=", 
       RowBox[{"GCD", "@@@", "m"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowSigns", "=", 
       RowBox[{"Sign", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"#", ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "!=", "0"}], "&"}], ",", "1"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
          "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowScalings", "*=", "rowSigns"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowScalings", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"rowScalings", ",", 
         RowBox[{
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"TrueQ", "[", 
               RowBox[{
                RowBox[{"#", "\[Element]", "Integers"}], "||", 
                RowBox[{"#", "\[Element]", "Rationals"}]}], "]"}]}], "&"}], 
            ")"}]}], "->", "1"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowCombinations", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"rowScalings", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "!=", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rowScalings", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"#", "==", "0"}], "]"}], ",", "1", ",", "#"}], "]"}], 
         "&"}], "/@", "rowScalings"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"scaledM", "=", 
       RowBox[{"m", "/", "rowScalings"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowCombinations", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"rowCombinations", ",", 
         RowBox[{
          RowBox[{"RowOrderingFunction", "[", 
           RowBox[{
           "scaledM", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
           "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowCombinations", "=", 
       RowBox[{"SplitBy", "[", 
        RowBox[{"rowCombinations", ",", 
         RowBox[{
          RowBox[{
          "scaledM", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"scaledM", "\[LeftDoubleBracket]", 
         RowBox[{"rowCombinations", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "\[RightDoubleBracket]"}], ",", "rowCombinations", ",", 
        "rowScalings"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"6413aa55-5006-42e0-b102-12ddd4c04258"]
}, Closed]],

Cell[CellGroupData[{

Cell["CombineColumns", "Subsection",ExpressionUUID->"44d817ac-220c-4567-98a5-0853f4107bea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CombineColumns", "[", 
    RowBox[{"m_", ",", "combinations_", ",", "scalings_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "combination", "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"m", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "combination"}], "\[RightDoubleBracket]"}], 
           "]"}], 
          RowBox[{
          "scalings", "\[LeftDoubleBracket]", "combination", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"combination", ",", "combinations"}], "}"}]}], "]"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"3f7dc769-cc9f-4639-81ec-0e80ad751ffb"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimplifyRows", "Subsection",ExpressionUUID->"e7917329-f193-4053-9098-2810c21a03d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyRows", "[", "tl_TransformationList", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "result", ",", "combinations", ",", "scalings"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", "tl"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"DiagonalMatrixQ", "[", 
              RowBox[{
              "result", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}]}], "&&", 
            RowBox[{"!", 
             RowBox[{"DiagonalMatrixQ", "[", 
              RowBox[{"result", "\[LeftDoubleBracket]", 
               RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "result", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "combinations", ",", 
               "scalings"}], "}"}], "=", 
             RowBox[{"AutoCombineRows", "[", 
              RowBox[{
              "result", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "\[LeftDoubleBracket]", 
              RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"CombineColumns", "[", 
              RowBox[{
               RowBox[{"result", "\[LeftDoubleBracket]", 
                RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",", 
               "combinations", ",", "scalings"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "result", "]"}], ",", "2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$CheckSimplifications", "&&", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "tl", "]"}], "==", 
             RowBox[{"Normal", "[", "result", "]"}]}], "]"}], "]"}]}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<ERROR: SimplifyRows failed.\>\"", ",", "Red"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"fad110a1-c919-4ad7-b8f0-a010b07aa6f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SimplifyTransformationList", "Subsection",ExpressionUUID->"19d2ca80-2bb4-40d8-bf4e-891e297fef0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyTransformationList", "[", 
    RowBox[{"tl_", "/;", 
     RowBox[{"TransformationListQ", "[", "tl", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "i", ",", "combined"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"SimplifyRows", "[", 
        RowBox[{
         RowBox[{"SimplifyRows", "[", 
          RowBox[{"tl", "\[Transpose]"}], "]"}], "\[Transpose]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", 
         RowBox[{"Length", "[", "result", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"combined", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"result", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"i", "+", "1"}]}], "}"}], "\[RightDoubleBracket]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OperationCost", "[", "combined", "]"}], "<=", 
            RowBox[{"OperationCost", "[", 
             RowBox[{"result", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "}"}], "\[RightDoubleBracket]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
             "result", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              "=", 
             RowBox[{"Normal", "[", 
              RowBox[{"result", "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "+", "1"}]}], "}"}], "\[RightDoubleBracket]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"result", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"++", "i"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"SimplifyRows", "[", 
        RowBox[{
         RowBox[{"SimplifyRows", "[", 
          RowBox[{"result", "\[Transpose]"}], "]"}], "\[Transpose]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$CheckSimplifications", "&&", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "tl", "]"}], "==", 
             RowBox[{"Normal", "[", "result", "]"}]}], "]"}], "]"}]}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<ERROR: SimplifyTransformationList failed.\>\"", ",", "Red"}], 
          "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"fcec5036-e376-49c2-845f-8919af0b417e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SimplifyBilinearForm", "Subsection",ExpressionUUID->"b05c3581-dcf9-4b2c-8f91-1169ada21bb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"blf_", "/;", 
     RowBox[{"BilinearFormQ", "[", "blf", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "inputTransformation", ",", "\[IndentingNewLine]", 
       "outputTransformation", ",", "\[IndentingNewLine]", 
       "kernelTransformation", ",", "\[IndentingNewLine]", "result", ",", "h",
        ",", "testKernel", ",", "m", ",", "c", ",", "si", ",", "so"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputTransformation", "=", 
       RowBox[{"SimplifyTransformationList", "[", 
        RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"outputTransformation", "=", 
       RowBox[{"SimplifyTransformationList", "[", 
        RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"kernelTransformation", "=", 
       RowBox[{"SimplifyTransformationList", "[", 
        RowBox[{"blf", "[", "\"\<KernelTransformation\>\"", "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "c", ",", "si"}], "}"}], "=", 
       RowBox[{"AutoCombineRows", "[", 
        RowBox[{
        "inputTransformation", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "c", ",", "so"}], "}"}], "=", 
       RowBox[{"AutoCombineRows", "[", 
        RowBox[{
        "outputTransformation", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "inputTransformation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "/=", "si"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "outputTransformation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "/=", "so"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "kernelTransformation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "*=", 
       RowBox[{"si", " ", "so"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"inputTransformation", "=", 
       RowBox[{
       "SimplifyTransformationList", "[", "inputTransformation", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"outputTransformation", "=", 
       RowBox[{
       "SimplifyTransformationList", "[", "outputTransformation", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"kernelTransformation", "=", 
       RowBox[{
       "SimplifyTransformationList", "[", "kernelTransformation", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"BilinearForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "\"\<InputTransformation\>\"", "->", "inputTransformation"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<OutputTransformation\>\"", "->", "outputTransformation"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
          "\"\<KernelTransformation\>\"", "->", "kernelTransformation"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testKernel", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"h", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "kernelTransformation", "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$CheckSimplifications", "&&", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"result", "[", "testKernel", "]"}], "]"}], "==", 
             RowBox[{"Normal", "[", 
              RowBox[{"blf", "[", "testKernel", "]"}], "]"}]}], "]"}], 
           "]"}]}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<ERROR: SimplifyBilinearForm failed.\>\"", ",", "Red"}],
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"f86493cb-7544-4404-b330-ff763191f08b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["TransposeBilinearForm", "Subsection",ExpressionUUID->"756f54da-01ba-4984-a43c-0a6f1e636619"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"TransposeBilinearForm", ",", "transposeBilinearForm"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransposeBilinearForm", "::", "kernel"}], "=", 
   "\"\<TransposeBilinearForm requires the full kernel transformation.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransposeBilinearForm", "::", "fail"}], "=", 
    "\"\<TransposeBilinearForm only works for convolutions with modulus of \
the form x^n+k.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transposeBilinearForm", "[", "blf_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "it", ",", "ot", ",", "kt", ",", "transposed", ",", "kernel", ",", 
        "h"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"BilinearFormQ", "[", "blf", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"BilinearForm", "::", "valid"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kt", "=", 
        RowBox[{"blf", "[", "\"\<KernelTransformation\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "kt", "]"}], "=!=", "TransformationList"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"TransposeBilinearForm", "::", "kernel"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"Equal", "@@", 
           RowBox[{"BilinearFormLengths", "[", "blf", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"TransposeBilinearForm", "::", "fail"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"it", "=", 
        RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ot", "=", 
        RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ot", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{"ot", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kt", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{"kt", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ot", ",", "kt"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{"kt", ",", "ot"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"transposed", "=", 
        RowBox[{"BilinearForm", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<InputTransformation\>\"", "->", "it"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<OutputTransformation\>\"", "->", "ot"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<KernelTransformation\>\"", "->", "kt"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kernel", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"h", ",", 
          RowBox[{
           RowBox[{"BilinearFormLengths", "[", "blf", "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"transposed", "[", "kernel", "]"}], "]"}], "==", 
             RowBox[{"Normal", "[", 
              RowBox[{"blf", "[", "kernel", "]"}], "]"}]}], "]"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"TransposeBilinearForm", "::", "fail"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "transposed"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransposeBilinearForm", "[", "blf_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SimplifyBilinearForm", "[", "result", "]"}], "/;", 
     RowBox[{"Catch", "[", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"transposeBilinearForm", "[", "blf", "]"}]}], ";", "True"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"40859783-41d8-4ce2-b25f-5744e345879a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourier Transforms", "Section",ExpressionUUID->"9b6ae82e-902a-47cf-a5ff-d21fa6cb1b43"],

Cell[CellGroupData[{

Cell["RaderFft", "Subsection",ExpressionUUID->"9ce20459-ac26-4efc-82a7-ef2004432df3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RaderFft", "[", "blf_BilinearForm", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "transformation", ",", "m", ",", "\[IndentingNewLine]", "n", ",", "g", 
       ",", "permutation", ",", "mean", ",", "\[IndentingNewLine]", 
       "coefficients", ",", "c", ",", "\[IndentingNewLine]", "lhs", ",", 
       "rhs", ",", "equations", ",", "\[IndentingNewLine]", "outputTransform",
        ",", "ordering"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"transformation", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"OperationCost", "[", 
            RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], "]"}], 
           "+", 
           RowBox[{"OperationCost", "[", 
            RowBox[{
             RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], 
             "\[Transpose]"}], "]"}]}], "\[IndentingNewLine]", "<", 
          RowBox[{
           RowBox[{"OperationCost", "[", 
            RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}], "]"}], 
           "+", 
           RowBox[{"OperationCost", "[", 
            RowBox[{
             RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}], 
             "\[Transpose]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"blf", "[", "\"\<OutputTransformation\>\"", "]"}], ",", 
         RowBox[{"blf", "[", "\"\<InputTransformation\>\"", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Normal", "[", "transformation", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "transformation", "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", "1"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"PrimitiveRoot", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"permutation", "=", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"g", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "2"}]}], "]"}], ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"permutation", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "\[LeftDoubleBracket]", 
        "permutation", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"transformation", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"transformation", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ".", 
        "permutation"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"m", ".", "permutation"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"mean", "=", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{
         RowBox[{"Length", "[", "m", "]"}], "+", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mean", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"m", "\[Transpose]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transformation", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DirectSum", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "1", "}"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
        "transformation"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"transformation", ",", "mean"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"mean", ".", 
        RowBox[{"DirectSum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}], ",", "m"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coefficients", "=", 
       RowBox[{"Power", "[", 
        RowBox[{"c", ",", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "m", "]"}], "]"}], "-", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"m", "\[Transpose]"}], ".", 
          RowBox[{"DiagonalMatrix", "[", "coefficients", "]"}], ".", "m"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"CoefficientList", "[", 
            RowBox[{"#", ",", "c"}], "]"}], ",", 
           RowBox[{"Length", "[", "m", "]"}]}], "]"}], "&"}], "/@", "lhs"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rhs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"FourierMatrix", "[", "n", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"lhs", "\[Transpose]"}], ",", "rhs"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"equations", ",", "Most"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"equations", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhs", "=", 
       RowBox[{"equations", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coefficients", "=", 
       RowBox[{"RootReduce", "@", 
        RowBox[{"Expand", "[", 
         RowBox[{"LeastSquares", "[", 
          RowBox[{"lhs", ",", "rhs", ",", 
           RowBox[{"Method", "->", "\"\<Direct\>\""}]}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"transformation", "=", 
       RowBox[{"SimplifyTransformationList", "[", "transformation", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"outputTransform", "=", 
       RowBox[{"transformation", "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ordering", "=", 
       RowBox[{"OrderingBy", "[", 
        RowBox[{
         RowBox[{
         "transformation", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", "RowOrderingFunction"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "transformation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{
        "transformation", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "ordering", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coefficients", "=", 
       RowBox[{
       "coefficients", "\[LeftDoubleBracket]", "ordering", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputTransform", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"outputTransform", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], 
         "\[LeftDoubleBracket]", "ordering", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputTransform", "=", 
       RowBox[{"SimplifyTransformationList", "[", "outputTransform", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"outputTransform", ",", 
        RowBox[{"TransformationList", "[", 
         RowBox[{"DiagonalMatrix", "[", "coefficients", "]"}], "]"}], ",", 
        "transformation"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"5b2996ce-9355-40a0-9eeb-5c7cc5cd1188"]
}, Open  ]],

Cell[CellGroupData[{

Cell["GoodThomasFft", "Subsection",ExpressionUUID->"fb16f5d5-e64d-42ac-9bf9-9c127a6163cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GoodThomasFft", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{"fft1_TransformationList", ",", "fft2_TransformationList"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "len1", ",", "len2", ",", "len", ",", "len1i", ",", "len2i", ",", "n", 
       ",", "k", ",", "p", ",", "q", ",", "i", ",", "j", ",", "a1", ",", "b1",
        ",", "c1", ",", "a2", ",", "b2", ",", "c2", ",", "outputTransform", 
       ",", "coefficients", ",", "transformation", ",", "ordering"}], 
      "\[IndentingNewLine]", "}"}], ",", "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len1", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "fft1", "]"}], "\[LeftDoubleBracket]", "1",
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"len2", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "fft2", "]"}], "\[LeftDoubleBracket]", "1",
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"len", "=", 
       RowBox[{"len1", "\[Times]", "len2"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"len1i", "=", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"len1", ",", 
         RowBox[{"-", "1"}], ",", "len2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"len2i", "=", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"len2", ",", 
         RowBox[{"-", "1"}], ",", "len1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", " ", "len2"}], "+", 
          RowBox[{"j", " ", "len1"}]}], ",", "len"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", " ", "len2", " ", "len2i"}], "+", 
          RowBox[{"j", " ", "len1", " ", "len1i"}]}], ",", "len"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "len", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", "+", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"i", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"len2", "-", "1"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"len1", "-", "1"}]}], "}"}]}], "]"}], "\[Transpose]"}],
           "]"}]}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "len", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", "+", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"k", "[", 
              RowBox[{"i", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"len2", "-", "1"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"len1", "-", "1"}]}], "}"}]}], "]"}], "\[Transpose]"}],
           "]"}]}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"Position", " ", "[", 
        RowBox[{"fft1", ",", 
         RowBox[{"_", "?", "DiagonalMatrixQ"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "i", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"i", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"a1", "=", 
          RowBox[{"fft1", "\[LeftDoubleBracket]", 
           RowBox[{";;", 
            RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"b1", "=", 
          RowBox[{
          "fft1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", 
         RowBox[{"c1", "=", 
          RowBox[{"fft1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], 
        RowBox[{
         RowBox[{"a1", "=", "fft1"}], ";", 
         RowBox[{"b1", "=", 
          RowBox[{"IdentityMatrix", "[", "len1", "]"}]}], ";", 
         RowBox[{"c1", "=", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"IdentityMatrix", "[", "len1", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"Position", " ", "[", 
        RowBox[{"fft2", ",", 
         RowBox[{"_", "?", "DiagonalMatrixQ"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "i", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"i", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"a2", "=", 
          RowBox[{"fft2", "\[LeftDoubleBracket]", 
           RowBox[{";;", 
            RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"b2", "=", 
          RowBox[{
          "fft2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", 
         RowBox[{"c2", "=", 
          RowBox[{"fft2", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], 
        RowBox[{
         RowBox[{"a2", "=", "fft2"}], ";", 
         RowBox[{"b2", "=", 
          RowBox[{"IdentityMatrix", "[", "len2", "]"}]}], ";", 
         RowBox[{"c2", "=", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"IdentityMatrix", "[", "len2", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outputTransform", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"a2", ",", "a1"}], "]"}], ",", 
         RowBox[{"q", "\[Transpose]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coefficients", "=", 
       RowBox[{"Diagonal", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"b2", ",", "b1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transformation", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"c2", ",", "c1"}], "]"}], ",", "p"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"transformation", "=", 
       RowBox[{"SimplifyTransformationList", "[", "transformation", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ordering", "=", 
       RowBox[{"OrderingBy", "[", 
        RowBox[{
         RowBox[{
         "transformation", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", "RowOrderingFunction"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "transformation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{
        "transformation", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "ordering", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coefficients", "=", 
       RowBox[{
       "coefficients", "\[LeftDoubleBracket]", "ordering", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputTransform", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"outputTransform", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], 
         "\[LeftDoubleBracket]", "ordering", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputTransform", "=", 
       RowBox[{"SimplifyTransformationList", "[", "outputTransform", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"outputTransform", ",", 
        RowBox[{"TransformationList", "[", 
         RowBox[{"DiagonalMatrix", "[", "coefficients", "]"}], "]"}], ",", 
        "transformation"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"32b023ad-d430-44a9-9074-d599202d8029"]
}, Open  ]],

Cell["CooleyTukeyFft", "Subsection",ExpressionUUID->"f32bbc94-6737-4c08-980d-bdf016263bfc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Convolutions", "Section",ExpressionUUID->"2684ef23-0251-4b47-8f63-e2fb5e07ac34"],

Cell["\<\
Subtile Vorzeichenwechsel, z.B. x-1 statt x+1 bei linear[2] \
k\[ODoubleDot]nnen bei den FFT zu einer ge\[ADoubleDot]nderten Zahl \
Additionen f\[UDoubleDot]hren. Ggf. nochmal damit spielen.\
\>", "Text",ExpressionUUID->"78b9c4a2-63ec-4e70-9941-cccf5891353e"],

Cell[CellGroupData[{

Cell["Linear-1", "Subsection",ExpressionUUID->"d5cc4a1b-db49-46d3-b42c-5ac52875ab3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "1", "]"}], "=", 
   RowBox[{"BilinearForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<InputTransformation\>\"", "\[Rule]", 
       RowBox[{"TransformationList", "[", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}], "]"}]}], ",", 
      RowBox[{"\"\<KernelTransformation\>\"", "\[Rule]", 
       RowBox[{"TransformationList", "[", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}], "]"}]}], ",", 
      RowBox[{"\"\<OutputTransformation\>\"", "\[Rule]", 
       RowBox[{"TransformationList", "[", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"60eb0fca-6999-4b00-b170-1d05031d0998"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-2", "Subsection",ExpressionUUID->"b8794409-fc86-433b-8d72-ae0e7f673d05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "2", "]"}], "=", 
   RowBox[{"WinogradLinearConvolution", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "+", "1"}], "&"}], ",", 
         RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "&"}], ",", 
         RowBox[{"linear", "[", "1", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "2", ",", "2"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"0c8d1918-0a9f-44bf-b25e-2b9d0b1ae5a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear-4", "Subsection",ExpressionUUID->"2560ff31-8e4a-4cb9-a88a-68bd579e0c29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "4", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "2", "]"}], ",", 
      RowBox[{"linear", "[", "2", "]"}], ",", "1"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"3cc87f50-e1e4-4054-920a-78930de6704c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear-8", "Subsection",ExpressionUUID->"ee67c482-5a93-4472-bcab-773ad8d6127f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "8", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "2", "]"}], ",", 
      RowBox[{"linear", "[", "4", "]"}], ",", "3"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"64abe53f-d1ee-49a0-9c64-e40039a2be7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-16", "Subsection",ExpressionUUID->"8633c564-36a4-4dbc-8720-e9d7408ddd13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "16", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "4", "]"}], ",", 
      RowBox[{"linear", "[", "4", "]"}], ",", "3"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"34f1150e-9b35-4672-bf2e-fc272d8cb72c"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "2"], "-", "1"}]], "Subsection",ExpressionUUID->\
"ff435c87-8c3c-4c7a-b4ed-55e6e051521b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "2", "]"}], "=", 
   RowBox[{"WinogradModularConvolution", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "+", "1"}], "&"}], ",", 
         RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", "1"}], "&"}], ",", 
         RowBox[{"linear", "[", "1", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "2", ",", "2"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"148d8d50-7899-4130-97c3-125035809305"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-3", "Subsection",ExpressionUUID->"0e6570dd-4eac-4b76-bddc-11f73731a5eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "3", "]"}], "=", 
   RowBox[{"WinogradLinearConvolution", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["#", "2"], "-", "1"}], "&"}], ",", 
         RowBox[{"cyclic", "[", "2", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["#", "2"], "&"}], ",", 
         RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "3", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"25e3a635-bacb-4d2e-b455-0491dc33d441"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-6", "Subsection",ExpressionUUID->"8530284c-5a05-44d5-80db-73cb10a74e5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "6", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "2", "]"}], ",", 
      RowBox[{"linear", "[", "3", "]"}], ",", "2"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"5964d25a-a8c5-4daf-bc49-b7a0dc04bd74"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-9", "Subsection",ExpressionUUID->"d534826c-455d-4e66-96e9-e0dd03b614f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "9", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "3", "]"}], ",", 
      RowBox[{"linear", "[", "3", "]"}], ",", "2"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"92007bfc-db0e-438e-ade3-64309890f10d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-12", "Subsection",ExpressionUUID->"cf93ef1a-6315-4bba-abb9-4fbf7251f47e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "12", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "2", "]"}], ",", 
      RowBox[{"linear", "[", "6", "]"}], ",", "5"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"ef71a77c-c363-4ae6-a59f-70a25c8d7e5e"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "3"], "-", "1"}]], "Subsection",ExpressionUUID->\
"9f7fd45b-d413-40d3-a7bd-50a832fe4eeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "3", "]"}], "=", 
   RowBox[{"WinogradModularConvolution", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", "1"}], "&"}], ",", 
         RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["#", "2"], "+", "#", "+", "1"}], "&"}], ",", 
         RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "3", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"d4d77a4c-1550-44c3-b9b3-ddbc3be7a611"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "4"], "-", "1"}]], "Subsection",ExpressionUUID->\
"da7371bc-d6bc-44d8-8c46-4e046bf96ccf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "4", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "2"], "-", "1"}], "&"}], ",", 
          RowBox[{"cyclic", "[", "2", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "2"], "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "4", ",", "4"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"9afdc87b-6773-4156-9085-f7e96458a8a6"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "5"], "-", "1"}]], "Subsection",ExpressionUUID->\
"8be2a651-2a34-4894-bf38-d4626b4b4c1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "5", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "4"], "+", 
            SuperscriptBox["#", "3"], "+", 
            SuperscriptBox["#", "2"], "+", "#", "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "4", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "5", ",", "5"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"c44b5224-80be-447c-8a37-671a4f22f0dc"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "6"], "-", "1"}]], "Subsection",ExpressionUUID->\
"9becef1b-7e14-4e2d-aee3-82da16eb9ff6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "6", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "3"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "3", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "3"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "3", ",", "3"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "6", ",", "6"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"088e625d-8761-48fb-add6-146520d11e8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear-5", "Subsection",ExpressionUUID->"c743d61a-7aea-4011-8052-4378469b9478"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "5", "]"}], "=", 
   RowBox[{"WinogradLinearConvolution", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["#", "6"], "-", "1"}], "&"}], ",", 
         RowBox[{"cyclic", "[", "6", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["#", "2"], "&"}], ",", 
         RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "5", ",", "5"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"89da03f1-2198-44a8-a619-38df0cb927cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear-10", "Subsection",ExpressionUUID->"f9957591-c3bd-4f72-881d-72a1cd9d1a84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linear", "[", "10", "]"}], "=", 
   RowBox[{"SimplifyBilinearForm", "[", 
    RowBox[{"IteratedConvolution", "[", 
     RowBox[{
      RowBox[{"linear", "[", "2", "]"}], ",", 
      RowBox[{"linear", "[", "5", "]"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"912f8456-59e6-4a86-bc1e-40a7b8aa27d7"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "7"], "-", "1"}]], "Subsection",ExpressionUUID->\
"21a22c68-2b0c-4a73-89ed-3e1492ac35cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "7", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "6"], "+", 
            SuperscriptBox["#", "5"], "+", 
            SuperscriptBox["#", "4"], "+", 
            SuperscriptBox["#", "3"], "+", 
            SuperscriptBox["#", "2"], "+", "#", "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "6", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "7", ",", "7"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"4cd1fdb6-2f44-4bb3-b275-730ba403d429"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "8"], "-", "1"}]], "Subsection",ExpressionUUID->\
"0ffc2de2-33e1-4324-ba23-e79f239a332b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "8", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "4"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "4", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "4"], "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "4", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "8", ",", "8"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"3e15947f-6048-47c1-a8f4-5d593a617b05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "9"], "-", "1"}]], "Subsection",ExpressionUUID->\
"204d9537-5fc2-4455-80c3-4a7542ea704e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "9", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "3"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "3", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "6"], "+", 
            SuperscriptBox["#", "3"], "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "6", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "9", ",", "9"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"a74249fe-259a-40ec-8649-32008b3f526b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "10"], "-", "1"}]], "Subsection",ExpressionUUID->\
"1e41c2a6-07dd-4bf0-a7e4-6f13044845c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "10", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "5"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "5", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "5"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "4"], "-", 
                  SuperscriptBox["#", "3"], "+", 
                  SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "4", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "5", ",", "5"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "10", ",", "10"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"b640e460-5261-486c-a9fd-46280584921e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "11"], "-", "1"}]], "Subsection",ExpressionUUID->\
"d3ba6148-2c78-491a-a18b-9710a6112758"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "11", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "10"], "+", 
            SuperscriptBox["#", "9"], "+", 
            SuperscriptBox["#", "8"], "+", 
            SuperscriptBox["#", "7"], "+", 
            SuperscriptBox["#", "6"], "+", 
            SuperscriptBox["#", "5"], "+", 
            SuperscriptBox["#", "4"], "+", 
            SuperscriptBox["#", "3"], "+", 
            SuperscriptBox["#", "2"], "+", "#", "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "10", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "11", ",", "11"}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"649bcf3e-8b75-48e7-ad56-9556b91256b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "12"], "-", "1"}]], "Subsection",ExpressionUUID->\
"059998c7-6ebf-4f42-85ea-84b4c0626800"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "12", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "6"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "6", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "6"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "2"], "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "2", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "4"], "-", 
                  SuperscriptBox["#", "2"], "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "4", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "6", ",", "6"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "12", ",", "12"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"2730bb40-8adf-40c2-9d0b-a1fa585931cd"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "14"], "-", "1"}]], "Subsection",ExpressionUUID->\
"1e7ad356-4c16-4077-b010-43df289e3b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "14", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "7"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "7", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "7"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "6"], "-", 
                  SuperscriptBox["#", "5"], "+", 
                  SuperscriptBox["#", "4"], "-", 
                  SuperscriptBox["#", "3"], "+", 
                  SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "6", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "7", ",", "7"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "14", ",", "14"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"a3653299-6ccd-4975-92e2-61843adffedb"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "15"], "-", "1"}]], "Subsection",ExpressionUUID->\
"6229a318-8228-4770-bf0d-f1b7f8c57a86"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "15", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "5"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "5", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "10"], "+", 
            SuperscriptBox["#", "5"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "2"], "+", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "2", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "8"], "-", 
                  SuperscriptBox["#", "7"], "+", 
                  SuperscriptBox["#", "5"], "-", 
                  SuperscriptBox["#", "4"], "+", 
                  SuperscriptBox["#", "3"], "-", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "8", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "10", ",", "10"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "15", ",", "15"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"c81dde56-43c5-434b-98a3-78188aae1017"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "16"], "-", "1"}]], "Subsection",ExpressionUUID->\
"082f449c-a7b1-4c20-a0a6-d0549e3f06ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "16", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "8"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "8", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "8"], "+", "1"}], "&"}], ",", 
          RowBox[{"linear", "[", "8", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "}"}], ",", "16", ",", "16"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"99be8bde-e684-4b10-9391-b8ef352a4da6"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "18"], "-", "1"}]], "Subsection",ExpressionUUID->\
"32c4fc0d-baba-4c49-a768-6f19f01f2c93"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "18", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "9"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "9", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "9"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "3"], "+", "1"}], "&"}], ",", 
                RowBox[{"WinogradModularConvolution", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "+", "1"}], "&"}], ",", 
                    RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], 
                    ",", 
                    RowBox[{"linear", "[", "2", "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "3", ",", "3"}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "6"], "-", 
                  SuperscriptBox["#", "3"], "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "6", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "9", ",", "9"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "18", ",", "18"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[100]:=",ExpressionUUID->"c07e731c-28f1-4db0-a87e-c556ac31a844"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "22"], "-", "1"}]], "Subsection",ExpressionUUID->\
"3d420ff8-4a03-45b2-b33c-90b8cda106db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "22", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "11"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "11", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "11"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "10"], "-", 
                  SuperscriptBox["#", "9"], "+", 
                  SuperscriptBox["#", "8"], "-", 
                  SuperscriptBox["#", "7"], "+", 
                  SuperscriptBox["#", "6"], "-", 
                  SuperscriptBox["#", "5"], "+", 
                  SuperscriptBox["#", "4"], "-", 
                  SuperscriptBox["#", "3"], "+", 
                  SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "10", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "11", ",", "11"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "22", ",", "22"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"78dffcb9-f94e-41b8-bafe-a22849950375"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "28"], "-", "1"}]], "Subsection",ExpressionUUID->\
"e9216791-30cf-4cfe-9885-f84dfd4563be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "28", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "14"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "14", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "14"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "2"], "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "2", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "12"], "-", 
                  SuperscriptBox["#", "10"], "+", 
                  SuperscriptBox["#", "8"], "-", 
                  SuperscriptBox["#", "6"], "+", 
                  SuperscriptBox["#", "4"], "-", 
                  SuperscriptBox["#", "2"], "+", "1"}], "&"}], ",", 
                RowBox[{"linear", "[", "12", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "14", ",", "14"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "28", ",", "28"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[102]:=",ExpressionUUID->"e4e81140-0191-4e23-a5ae-d15560cd2521"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "30"], "-", "1"}]], "Subsection",ExpressionUUID->\
"d13281d9-1548-49af-ab59-9821d8829b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "30", "]"}], "=", 
   RowBox[{"TransposeBilinearForm", "@", 
    RowBox[{"WinogradModularConvolution", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "15"], "-", "1"}], "&"}], ",", 
          RowBox[{"TransposeBilinearForm", "@", 
           RowBox[{"cyclic", "[", "15", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["#", "15"], "+", "1"}], "&"}], ",", 
          RowBox[{"WinogradModularConvolution", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "5"], "+", "1"}], "&"}], ",", 
                RowBox[{"WinogradModularConvolution", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "+", "1"}], "&"}], ",", 
                    RowBox[{"linear", "[", "1", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["#", "4"], "-", 
                    SuperscriptBox["#", "3"], "+", 
                    SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], 
                    ",", 
                    RowBox[{"linear", "[", "4", "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "5", ",", "5"}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["#", "10"], "-", 
                  SuperscriptBox["#", "5"], "+", "1"}], "&"}], ",", 
                RowBox[{"WinogradModularConvolution", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["#", "2"], "-", "#", "+", "1"}], "&"}], 
                    ",", 
                    RowBox[{"linear", "[", "2", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["#", "8"], "+", 
                    SuperscriptBox["#", "7"], "-", 
                    SuperscriptBox["#", "5"], "-", 
                    SuperscriptBox["#", "4"], "-", 
                    SuperscriptBox["#", "3"], "+", "#", "+", "1"}], "&"}], 
                    ",", 
                    RowBox[{"linear", "[", "8", "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "10", ",", "10"}], 
                 "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", "15", 
            ",", "15"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "30", ",", "30"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"ce7dcb6a-44a1-4c70-a7eb-64e2b4b28d1d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Playground", "Section",ExpressionUUID->"ebbf719e-5ee0-4421-b16d-611848a844fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CooleyTukeyFft", "[", 
   RowBox[{"fft1_TransformationList", ",", "fft2_TransformationList"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "i", ",", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "fft1", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", "fft2", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kk", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"KernelKroneckerProduct", "[", 
           RowBox[{"fft1", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"IdentityMatrix", "[", "n", "]"}], "}"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", "\[Pi]", " ", "I", " ", "i", " ", 
                  RowBox[{"j", "/", 
                   RowBox[{"(", 
                    RowBox[{"m", " ", "n"}], ")"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "0", ",", 
                  RowBox[{"m", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"2", "*", "$MachinePrecision"}]}], "]"}], "}"}], ",", 
          RowBox[{"KernelKroneckerProduct", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"IdentityMatrix", "[", "m", "]"}], "}"}], "}"}], ",", 
            "fft2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kk", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"kk", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"m", " ", "n"}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"i", " ", "m"}], "+", "j", "+", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "0", ",", 
                 RowBox[{"m", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}], 
            "\[RightDoubleBracket]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "kk"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"SimplifyTransformationList", "@", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"fft1", ",", 
          RowBox[{"TransformationList", "[", 
           RowBox[{"IdentityMatrix", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TransformationList", "[", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], "\[Pi]", " ", "I", " ", "i", " ", 
               RowBox[{"j", "/", 
                RowBox[{"(", 
                 RowBox[{"m", " ", "n"}], ")"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0", ",", 
               RowBox[{"m", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"TransformationList", "[", 
           RowBox[{"IdentityMatrix", "[", "m", "]"}], "]"}], ",", "fft2"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TransformationList", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"m", " ", "n"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", " ", "m"}], "+", "j", "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0", ",", 
               RowBox[{"m", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}], 
          "\[RightDoubleBracket]"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"6c2a26e1-073c-4564-9d92-fec70e216f24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "2", "]"}], "=", 
   RowBox[{"TransformationList", "[", 
    RowBox[{"(", GridBox[{
       {"1", "1"},
       {"1", 
        RowBox[{"-", "1"}]}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "3", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "4", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "2", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[105]:=",ExpressionUUID->"feedf23b-6062-4115-a89a-513395bf5cda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "5", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "6", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "3", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "7", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "8", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "4", "]"}], ",", 
     RowBox[{"Fft", "[", "2", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"120f04fa-603a-40b2-9a4d-0834c66193e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "9", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "3", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "10", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "5", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "11", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "10", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "12", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "4", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"7249ffe0-e0ff-4090-b47a-73d88bc702a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "13", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "12", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "14", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "7", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "15", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "5", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "16", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "4", "]"}], ",", 
     RowBox[{"Fft", "[", "4", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"574a8c9e-fac8-461f-a719-455369a836e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "17", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "16", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "18", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "6", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "19", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "18", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "20", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "4", "]"}], ",", 
     RowBox[{"Fft", "[", "5", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"6487488f-32d5-4d74-8f25-ea881275aa11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "21", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "7", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "22", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "11", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "23", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "22", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "24", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "8", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"2c9fc796-dfb3-489d-87da-2db010e40b0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "25", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "5", "]"}], ",", 
     RowBox[{"Fft", "[", "5", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "26", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "2", "]"}], ",", 
     RowBox[{"Fft", "[", "13", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "27", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "3", "]"}], ",", 
     RowBox[{"Fft", "[", "9", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "28", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "4", "]"}], ",", 
     RowBox[{"Fft", "[", "7", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"b3e059d0-2180-4b93-87fd-c838685b3c34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "29", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "28", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "30", "]"}], "=", 
   RowBox[{"GoodThomasFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "5", "]"}], ",", 
     RowBox[{"Fft", "[", "6", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "31", "]"}], "=", 
   RowBox[{"RaderFft", "[", 
    RowBox[{"cyclic", "[", "30", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fft", "[", "32", "]"}], "=", 
   RowBox[{"CooleyTukeyFft", "[", 
    RowBox[{
     RowBox[{"Fft", "[", "4", "]"}], ",", 
     RowBox[{"Fft", "[", "8", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"f4baaead-93ca-42ae-8908-d431f3f75a87"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"TrueQ", "[", 
       RowBox[{"Equal", "@@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Normal", "[", 
             RowBox[{"Fft", "[", "i", "]"}], "]"}], "]"}], "-", 
           RowBox[{"FourierMatrix", "[", "i", "]"}]}], "]"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Length \>\"", ",", "i", ",", "\"\< operation count: \>\"", ",", 
        RowBox[{"OperationCount", "[", 
         RowBox[{"Fft", "[", "i", "]"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Length \>\"", ",", "i", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\< FAILED\>\"", ",", "Red"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2", ",", "32"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"627f0f6d-a396-49ea-9c00-842770011df8"],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorRules", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"0", "->", "White"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", "#", "]"}], "==", "1.0"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "#", "]"}], "==", "0.0"}], "||", 
                 RowBox[{
                  RowBox[{"Im", "[", "#", "]"}], "==", "0.0"}]}], ")"}]}], 
              "&"}], ")"}]}], "->", "Black"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Re", "[", "#", "]"}], "==", "0.0"}], "||", 
               RowBox[{
                RowBox[{"Im", "[", "#", "]"}], "==", "0.0"}]}], "&"}], 
             ")"}]}], "->", "Green"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "@", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Re", "[", "#", "]"}], "]"}]}], "==", 
               RowBox[{"Abs", "[", 
                RowBox[{"Im", "[", "#", "]"}], "]"}]}], "&"}], ")"}]}], "->", 
           "Blue"}], ",", "\[IndentingNewLine]", 
          RowBox[{"_", "->", "Red"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "200"}], "}"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"List", "@@", 
     RowBox[{"Fft", "[", "19", "]"}]}]}], ",", "\"\< \>\""}], "]"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"33852ac3-59f7-4abe-8d69-40ecacf56918"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "n1", "]"}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"dbc4e85a-3db6-4bd5-9bd1-28c08a35e9a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", 
    RowBox[{"4", "\[Times]", "8"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"separation", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"UnitVector", "[", 
         RowBox[{"n", ",", 
          RowBox[{
           RowBox[{"2", " ", "i"}], "+", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"UnitVector", "[", 
         RowBox[{"n", ",", 
          RowBox[{
           RowBox[{"4", " ", "i"}], "+", "2"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"UnitVector", "[", 
         RowBox[{"n", ",", 
          RowBox[{
           RowBox[{"4", " ", "i"}], "+", "4"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"longFft", "=", 
   RowBox[{"Fft", "[", 
    RowBox[{"n", "/", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shortFft", "=", 
    RowBox[{"Fft", "[", 
     RowBox[{"n", "/", "4"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"commonLength", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Length", "[", "longFft", "]"}], ",", 
      RowBox[{"Length", "[", "shortFft", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"longFft", "=", 
   RowBox[{"PadRight", "[", 
    RowBox[{"longFft", ",", "commonLength", ",", 
     RowBox[{"{", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "shortFft", "]"}], "\[LeftDoubleBracket]", 
        "2", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shortFft", "=", 
    RowBox[{"PadRight", "[", 
     RowBox[{"shortFft", ",", "commonLength", ",", 
      RowBox[{"{", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "shortFft", "]"}], "\[LeftDoubleBracket]",
          "2", "\[RightDoubleBracket]"}], "]"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subFfts", "=", 
    RowBox[{"DirectSum", "[", 
     RowBox[{"longFft", ",", "shortFft", ",", "shortFft"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twiddle1", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "2"}], "\[Pi]", " ", "I", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"n", "/", "4"}], "]"}], "-", "1"}], ")"}], "/", "n"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twiddle2", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "3"}], "\[Times]", "2", "\[Pi]", " ", "I", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"n", "/", "4"}], "]"}], "-", "1"}], ")"}], "/", "n"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"twiddles", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"n", "/", "2"}]}], "]"}], ",", "twiddle1", ",", "twiddle2"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fft2", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"UnitVector", "[", 
         RowBox[{"n", ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "+", 
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "-", 
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fft4", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"0", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "+", 
         RowBox[{"1", 
          RowBox[{"UnitVector", "[", 
           RowBox[{"n", ",", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"1", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "-", 
         RowBox[{"I", " ", 
          RowBox[{"UnitVector", "[", 
           RowBox[{"n", ",", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"0", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "-", 
         RowBox[{"1", 
          RowBox[{"UnitVector", "[", 
           RowBox[{"n", ",", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"UnitVector", "[", 
          RowBox[{"n", ",", 
           RowBox[{
            RowBox[{"1", 
             RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}], "+", 
         RowBox[{"I", " ", 
          RowBox[{"UnitVector", "[", 
           RowBox[{"n", ",", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"n", "/", "4"}]}], "+", "i", "+", "1"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"n", "/", "4"}], "-", "1"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SrFft", "[", "n", "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TransformationList", "[", "fft4", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TransformationList", "[", "fft2", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TransformationList", "[", 
      RowBox[{"DiagonalMatrix", "[", "twiddles", "]"}], "]"}], ",", 
     "\[IndentingNewLine]", "subFfts", ",", "\[IndentingNewLine]", 
     RowBox[{"TransformationList", "[", "separation", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"248682d9-5f6d-4080-875c-fdd73a591f04"]
}, Open  ]]
},
WindowSize->{1350, 669},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"58bea4aa-1a50-45f8-a214-598d33928eb0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 495, 14, 50, "Input",ExpressionUUID->"b6564691-30d1-4fc3-9aa5-560766b07003"],
Cell[CellGroupData[{
Cell[1078, 38, 78, 0, 67, "Section",ExpressionUUID->"d60adde2-62e7-4614-ac4b-cbc6159de9ac"],
Cell[1159, 40, 582, 15, 50, "Input",ExpressionUUID->"f51983fa-e17b-4809-bee8-0b31f41a702e"],
Cell[1744, 57, 587, 16, 50, "Input",ExpressionUUID->"90034c71-3dc1-44f2-b432-2a05e42b790f"],
Cell[2334, 75, 5297, 134, 570, "Input",ExpressionUUID->"b9caa872-1545-48d8-8e81-b93d400d01e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7668, 214, 92, 0, 67, "Section",ExpressionUUID->"4987bf19-9263-4ba4-8fdf-4a5e7fd10fd0"],
Cell[7763, 216, 278, 6, 50, "Input",ExpressionUUID->"5f290568-cece-4d43-bea7-f23b6a0e579f"],
Cell[CellGroupData[{
Cell[8066, 226, 96, 0, 54, "Subsection",ExpressionUUID->"51151581-3d18-4ed5-b7cd-f6ecbb56bc87"],
Cell[8165, 228, 992, 28, 70, "Input",ExpressionUUID->"5a3eaf7a-269d-4bec-b75c-5053edeb870b"]
}, Closed]],
Cell[CellGroupData[{
Cell[9194, 261, 83, 0, 38, "Subsection",ExpressionUUID->"3f97a7d6-c46c-4aba-bc53-4a4f4f338cd4"],
Cell[9280, 263, 482, 11, 29, "Input",ExpressionUUID->"ef79aeaa-4273-49c5-97fb-a96ff7ea416f"]
}, Closed]],
Cell[CellGroupData[{
Cell[9799, 279, 86, 0, 38, "Subsection",ExpressionUUID->"c1dd2725-d360-4de7-89cf-7c9cf5349451"],
Cell[9888, 281, 573, 13, 50, "Input",ExpressionUUID->"419eff5f-d604-45e3-a7b7-8fe40f7fd6b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[10498, 299, 87, 0, 38, "Subsection",ExpressionUUID->"9eab1af3-e85a-445c-a339-13d51b2a5bbc"],
Cell[10588, 301, 913, 22, 70, "Input",ExpressionUUID->"70f399fb-63e9-45c8-b687-7c2628328de5"]
}, Closed]],
Cell[CellGroupData[{
Cell[11538, 328, 83, 0, 38, "Subsection",ExpressionUUID->"a7780326-5938-4079-baa1-758de17eb9db"],
Cell[11624, 330, 380, 8, 29, "Input",ExpressionUUID->"7d4a91c6-cca2-4beb-8b7b-e9f76dfb13a5"]
}, Closed]],
Cell[CellGroupData[{
Cell[12041, 343, 86, 0, 38, "Subsection",ExpressionUUID->"93042c2a-c48d-4352-b5ab-9c59f635d30b"],
Cell[12130, 345, 1263, 33, 170, "Input",ExpressionUUID->"394e9831-c22a-417f-bbc5-b6cb61744ea4"]
}, Closed]],
Cell[CellGroupData[{
Cell[13430, 383, 93, 0, 38, "Subsection",ExpressionUUID->"c99bc931-d77f-471e-95f6-d78ee71e2a0f"],
Cell[13526, 385, 206, 3, 35, "Text",ExpressionUUID->"f0e191d7-4058-4ab8-b0ca-d61084625dd8"],
Cell[13735, 390, 4928, 114, 570, "Input",ExpressionUUID->"380c8e16-d739-45a0-a1c3-59fef16baf86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18700, 509, 84, 0, 54, "Subsection",ExpressionUUID->"f0e749a0-2bbb-41bf-ae3f-9627baa7c7e8"],
Cell[18787, 511, 174, 3, 29, "Input",ExpressionUUID->"8fa82d12-8e64-4b82-8740-1e7dc9f0b884"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[19010, 520, 86, 0, 53, "Section",ExpressionUUID->"50c88980-947d-4cc1-875f-48a83b033ff6"],
Cell[19099, 522, 151, 2, 29, "Input",ExpressionUUID->"d9f4b3f1-8796-47ff-a492-b308e0ce9529"],
Cell[19253, 526, 878, 21, 90, "Input",ExpressionUUID->"d53d0dfb-7e33-4e01-8bfe-05e049d09487"],
Cell[CellGroupData[{
Cell[20156, 551, 90, 0, 54, "Subsection",ExpressionUUID->"8827e60c-f515-44dd-97cd-3f1430b501c4"],
Cell[20249, 553, 3577, 88, 470, "Input",ExpressionUUID->"a200f0c2-9c16-40fc-af68-a162cb8a0032"]
}, Closed]],
Cell[CellGroupData[{
Cell[23863, 646, 150, 1, 38, "Subsection",ExpressionUUID->"37452684-5221-4518-b96e-9de71245a9c1"],
Cell[24016, 649, 1679, 40, 310, "Input",ExpressionUUID->"41fb8cb0-2662-4419-9be9-814cb11ac801"]
}, Closed]],
Cell[CellGroupData[{
Cell[25732, 694, 99, 0, 38, "Subsection",ExpressionUUID->"ae5d3d86-040a-498e-936a-5c78cdc2364e"],
Cell[25834, 696, 2660, 60, 490, "Input",ExpressionUUID->"fa792788-2df2-45f7-b293-0306a7b0df58"]
}, Closed]],
Cell[CellGroupData[{
Cell[28531, 761, 96, 0, 38, "Subsection",ExpressionUUID->"7aaf6a3c-f35e-455f-9a0e-8d6cad0d1145"],
Cell[28630, 763, 1736, 42, 170, "Input",ExpressionUUID->"c38483ab-9d02-45b5-acfa-77e2b7025d6f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[30415, 811, 85, 0, 53, "Section",ExpressionUUID->"5a3c1f13-c2dd-4e54-b9c8-fd04938979e0"],
Cell[CellGroupData[{
Cell[30525, 815, 96, 0, 54, "Subsection",ExpressionUUID->"8c599624-04d2-4733-8d29-dca5b3f8b80e"],
Cell[30624, 817, 390, 11, 29, "Input",ExpressionUUID->"3c8b1a3c-e5d3-4857-aaf2-d0da1e721632"]
}, Closed]],
Cell[CellGroupData[{
Cell[31051, 833, 100, 0, 38, "Subsection",ExpressionUUID->"c7d2fd2d-b5a9-4566-9a9b-03816ff423b4"],
Cell[31154, 835, 2315, 59, 310, "Input",ExpressionUUID->"42255f0a-16b8-44ff-9a8d-b520c2333600"]
}, Closed]],
Cell[CellGroupData[{
Cell[33506, 899, 93, 0, 38, "Subsection",ExpressionUUID->"43fff485-00b7-452b-9c1d-229b482d2f2c"],
Cell[33602, 901, 4416, 107, 570, "Input",ExpressionUUID->"e979a5de-385a-4254-889b-a966976f9987"]
}, Closed]],
Cell[CellGroupData[{
Cell[38055, 1013, 103, 0, 38, "Subsection",ExpressionUUID->"30103d7c-b2dd-4297-85ba-820bb6b8c5bd"],
Cell[38161, 1015, 21065, 495, 2110, "Input",ExpressionUUID->"39bb59e4-4ecd-4105-a6f3-18b51f8ddf6e"]
}, Closed]],
Cell[CellGroupData[{
Cell[59263, 1515, 102, 0, 38, "Subsection",ExpressionUUID->"238d8756-98ae-4c50-b877-7199ac76c891"],
Cell[59368, 1517, 8919, 204, 910, "Input",ExpressionUUID->"523500f0-a1ed-4b01-82b7-34e79c9cd463"]
}, Closed]],
Cell[CellGroupData[{
Cell[68324, 1726, 96, 0, 38, "Subsection",ExpressionUUID->"81e180d2-b45a-46d1-b223-3b11a8d0f45d"],
Cell[68423, 1728, 5344, 126, 870, "Input",ExpressionUUID->"8c33f2a8-4abd-49fe-be3a-8a0c5bbd2a0b"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[73816, 1860, 88, 0, 53, "Section",ExpressionUUID->"2f48bbe5-8fbc-4e5d-a865-9fb8514de3a5"],
Cell[73907, 1862, 1726, 52, 50, "Input",ExpressionUUID->"6eefe012-c2aa-472f-bc52-92743bdecb17"],
Cell[CellGroupData[{
Cell[75658, 1918, 92, 0, 54, "Subsection",ExpressionUUID->"2bed9d3d-c390-410e-b373-c39817c0deac"],
Cell[75753, 1920, 3400, 84, 330, "Input",ExpressionUUID->"6413aa55-5006-42e0-b102-12ddd4c04258"]
}, Closed]],
Cell[CellGroupData[{
Cell[79190, 2009, 91, 0, 38, "Subsection",ExpressionUUID->"44d817ac-220c-4567-98a5-0853f4107bea"],
Cell[79284, 2011, 885, 23, 50, "Input",ExpressionUUID->"3f7dc769-cc9f-4639-81ec-0e80ad751ffb"]
}, Closed]],
Cell[CellGroupData[{
Cell[80206, 2039, 89, 0, 38, "Subsection",ExpressionUUID->"e7917329-f193-4053-9098-2810c21a03d5"],
Cell[80298, 2041, 2881, 68, 270, "Input",ExpressionUUID->"fad110a1-c919-4ad7-b8f0-a010b07aa6f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83216, 2114, 103, 0, 54, "Subsection",ExpressionUUID->"19d2ca80-2bb4-40d8-bf4e-891e297fef0b"],
Cell[83322, 2116, 3371, 81, 350, "Input",ExpressionUUID->"fcec5036-e376-49c2-845f-8919af0b417e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86730, 2202, 97, 0, 54, "Subsection",ExpressionUUID->"b05c3581-dcf9-4b2c-8f91-1169ada21bb7"],
Cell[86830, 2204, 4698, 108, 670, "Input",ExpressionUUID->"f86493cb-7544-4404-b330-ff763191f08b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91565, 2317, 98, 0, 54, "Subsection",ExpressionUUID->"756f54da-01ba-4984-a43c-0a6f1e636619"],
Cell[91666, 2319, 5975, 144, 990, "Input",ExpressionUUID->"40859783-41d8-4ce2-b25f-5744e345879a"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97690, 2469, 92, 0, 67, "Section",ExpressionUUID->"9b6ae82e-902a-47cf-a5ff-d21fa6cb1b43"],
Cell[CellGroupData[{
Cell[97807, 2473, 85, 0, 54, "Subsection",ExpressionUUID->"9ce20459-ac26-4efc-82a7-ef2004432df3"],
Cell[97895, 2475, 8772, 206, 1090, "Input",ExpressionUUID->"5b2996ce-9355-40a0-9eeb-5c7cc5cd1188"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106704, 2686, 90, 0, 54, "Subsection",ExpressionUUID->"fb16f5d5-e64d-42ac-9bf9-9c127a6163cf"],
Cell[106797, 2688, 9336, 226, 870, "Input",ExpressionUUID->"32b023ad-d430-44a9-9074-d599202d8029"]
}, Open  ]],
Cell[116148, 2917, 91, 0, 54, "Subsection",ExpressionUUID->"f32bbc94-6737-4c08-980d-bdf016263bfc"]
}, Closed]],
Cell[CellGroupData[{
Cell[116276, 2922, 86, 0, 53, "Section",ExpressionUUID->"2684ef23-0251-4b47-8f63-e2fb5e07ac34"],
Cell[116365, 2924, 269, 4, 35, "Text",ExpressionUUID->"78b9c4a2-63ec-4e70-9941-cccf5891353e"],
Cell[CellGroupData[{
Cell[116659, 2932, 85, 0, 54, "Subsection",ExpressionUUID->"d5cc4a1b-db49-46d3-b42c-5ac52875ab3b"],
Cell[116747, 2934, 790, 20, 50, "Input",ExpressionUUID->"60eb0fca-6999-4b00-b170-1d05031d0998"]
}, Closed]],
Cell[CellGroupData[{
Cell[117574, 2959, 85, 0, 38, "Subsection",ExpressionUUID->"b8794409-fc86-433b-8d72-ae0e7f673d05"],
Cell[117662, 2961, 680, 19, 90, "Input",ExpressionUUID->"0c8d1918-0a9f-44bf-b25e-2b9d0b1ae5a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118379, 2985, 85, 0, 54, "Subsection",ExpressionUUID->"2560ff31-8e4a-4cb9-a88a-68bd579e0c29"],
Cell[118467, 2987, 389, 10, 29, "Input",ExpressionUUID->"3cc87f50-e1e4-4054-920a-78930de6704c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118893, 3002, 85, 0, 54, "Subsection",ExpressionUUID->"ee67c482-5a93-4472-bcab-773ad8d6127f"],
Cell[118981, 3004, 389, 10, 29, "Input",ExpressionUUID->"64abe53f-d1ee-49a0-9c64-e40039a2be7b"]
}, Closed]],
Cell[CellGroupData[{
Cell[119407, 3019, 86, 0, 38, "Subsection",ExpressionUUID->"8633c564-36a4-4dbc-8720-e9d7408ddd13"],
Cell[119496, 3021, 390, 10, 29, "Input",ExpressionUUID->"34f1150e-9b35-4672-bf2e-fc272d8cb72c"]
}, Closed]],
Cell[CellGroupData[{
Cell[119923, 3036, 135, 3, 38, "Subsection",ExpressionUUID->"ff435c87-8c3c-4c7a-b4ed-55e6e051521b"],
Cell[120061, 3041, 712, 20, 90, "Input",ExpressionUUID->"148d8d50-7899-4130-97c3-125035809305"]
}, Closed]],
Cell[CellGroupData[{
Cell[120810, 3066, 85, 0, 38, "Subsection",ExpressionUUID->"0e6570dd-4eac-4b76-bddc-11f73731a5eb"],
Cell[120898, 3068, 745, 21, 98, "Input",ExpressionUUID->"25e3a635-bacb-4d2e-b455-0491dc33d441"]
}, Closed]],
Cell[CellGroupData[{
Cell[121680, 3094, 85, 0, 38, "Subsection",ExpressionUUID->"8530284c-5a05-44d5-80db-73cb10a74e5b"],
Cell[121768, 3096, 389, 10, 29, "Input",ExpressionUUID->"5964d25a-a8c5-4daf-bc49-b7a0dc04bd74"]
}, Closed]],
Cell[CellGroupData[{
Cell[122194, 3111, 85, 0, 38, "Subsection",ExpressionUUID->"d534826c-455d-4e66-96e9-e0dd03b614f4"],
Cell[122282, 3113, 389, 10, 29, "Input",ExpressionUUID->"92007bfc-db0e-438e-ade3-64309890f10d"]
}, Closed]],
Cell[CellGroupData[{
Cell[122708, 3128, 86, 0, 38, "Subsection",ExpressionUUID->"cf93ef1a-6315-4bba-abb9-4fbf7251f47e"],
Cell[122797, 3130, 390, 10, 29, "Input",ExpressionUUID->"ef71a77c-c363-4ae6-a59f-70a25c8d7e5e"]
}, Closed]],
Cell[CellGroupData[{
Cell[123224, 3145, 135, 3, 38, "Subsection",ExpressionUUID->"9f7fd45b-d413-40d3-a7bd-50a832fe4eeb"],
Cell[123362, 3150, 755, 21, 96, "Input",ExpressionUUID->"d4d77a4c-1550-44c3-b9b3-ddbc3be7a611"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124154, 3176, 135, 3, 52, "Subsection",ExpressionUUID->"da7371bc-d6bc-44d8-8c46-4e046bf96ccf"],
Cell[124292, 3181, 840, 23, 98, "Input",ExpressionUUID->"9afdc87b-6773-4156-9085-f7e96458a8a6"]
}, Closed]],
Cell[CellGroupData[{
Cell[125169, 3209, 135, 3, 36, "Subsection",ExpressionUUID->"8be2a651-2a34-4894-bf38-d4626b4b4c1c"],
Cell[125307, 3214, 904, 24, 96, "Input",ExpressionUUID->"c44b5224-80be-447c-8a37-671a4f22f0dc"]
}, Closed]],
Cell[CellGroupData[{
Cell[126248, 3243, 135, 3, 36, "Subsection",ExpressionUUID->"9becef1b-7e14-4e2d-aee3-82da16eb9ff6"],
Cell[126386, 3248, 1553, 41, 162, "Input",ExpressionUUID->"088e625d-8761-48fb-add6-146520d11e8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127976, 3294, 85, 0, 54, "Subsection",ExpressionUUID->"c743d61a-7aea-4011-8052-4378469b9478"],
Cell[128064, 3296, 745, 21, 98, "Input",ExpressionUUID->"89da03f1-2198-44a8-a619-38df0cb927cb"]
}, Closed]],
Cell[CellGroupData[{
Cell[128846, 3322, 86, 0, 38, "Subsection",ExpressionUUID->"f9957591-c3bd-4f72-881d-72a1cd9d1a84"],
Cell[128935, 3324, 390, 10, 29, "Input",ExpressionUUID->"912f8456-59e6-4a86-bc1e-40a7b8aa27d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[129362, 3339, 135, 3, 36, "Subsection",ExpressionUUID->"21a22c68-2b0c-4a73-89ed-3e1492ac35cb"],
Cell[129500, 3344, 992, 26, 96, "Input",ExpressionUUID->"4cd1fdb6-2f44-4bb3-b275-730ba403d429"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130529, 3375, 135, 3, 54, "Subsection",ExpressionUUID->"0ffc2de2-33e1-4324-ba23-e79f239a332b"],
Cell[130667, 3380, 892, 24, 98, "Input",ExpressionUUID->"3e15947f-6048-47c1-a8f4-5d593a617b05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131596, 3409, 135, 3, 54, "Subsection",ExpressionUUID->"204d9537-5fc2-4455-80c3-4a7542ea704e"],
Cell[131734, 3414, 936, 25, 98, "Input",ExpressionUUID->"a74249fe-259a-40ec-8649-32008b3f526b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132707, 3444, 136, 3, 54, "Subsection",ExpressionUUID->"1e41c2a6-07dd-4bf0-a7e4-6f13044845c6"],
Cell[132846, 3449, 1656, 43, 162, "Input",ExpressionUUID->"b640e460-5261-486c-a9fd-46280584921e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134539, 3497, 136, 3, 52, "Subsection",ExpressionUUID->"d3ba6148-2c78-491a-a18b-9710a6112758"],
Cell[134678, 3502, 1176, 31, 96, "Input",ExpressionUUID->"649bcf3e-8b75-48e7-ad56-9556b91256b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135891, 3538, 136, 3, 54, "Subsection",ExpressionUUID->"059998c7-6ebf-4f42-85ea-84b4c0626800"],
Cell[136030, 3543, 1636, 43, 164, "Input",ExpressionUUID->"2730bb40-8adf-40c2-9d0b-a1fa585931cd"]
}, Closed]],
Cell[CellGroupData[{
Cell[137703, 3591, 136, 3, 36, "Subsection",ExpressionUUID->"1e7ad356-4c16-4077-b010-43df289e3b08"],
Cell[137842, 3596, 1756, 45, 162, "Input",ExpressionUUID->"a3653299-6ccd-4975-92e2-61843adffedb"]
}, Closed]],
Cell[CellGroupData[{
Cell[139635, 3646, 136, 3, 36, "Subsection",ExpressionUUID->"6229a318-8228-4770-bf0d-f1b7f8c57a86"],
Cell[139774, 3651, 1853, 47, 164, "Input",ExpressionUUID->"c81dde56-43c5-434b-98a3-78188aae1017"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141664, 3703, 136, 3, 52, "Subsection",ExpressionUUID->"082f449c-a7b1-4c20-a0a6-d0549e3f06ab"],
Cell[141803, 3708, 895, 24, 98, "Input",ExpressionUUID->"99be8bde-e684-4b10-9391-b8ef352a4da6"]
}, Closed]],
Cell[CellGroupData[{
Cell[142735, 3737, 136, 3, 38, "Subsection",ExpressionUUID->"32c4fc0d-baba-4c49-a768-6f19f01f2c93"],
Cell[142874, 3742, 2393, 61, 228, "Input",ExpressionUUID->"c07e731c-28f1-4db0-a87e-c556ac31a844"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145304, 3808, 136, 3, 54, "Subsection",ExpressionUUID->"3d420ff8-4a03-45b2-b33c-90b8cda106db"],
Cell[145443, 3813, 1967, 50, 162, "Input",ExpressionUUID->"78dffcb9-f94e-41b8-bafe-a22849950375"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147447, 3868, 136, 3, 54, "Subsection",ExpressionUUID->"e9216791-30cf-4cfe-9885-f84dfd4563be"],
Cell[147586, 3873, 1848, 48, 164, "Input",ExpressionUUID->"e4e81140-0191-4e23-a5ae-d15560cd2521"]
}, Closed]],
Cell[CellGroupData[{
Cell[149471, 3926, 136, 3, 38, "Subsection",ExpressionUUID->"d13281d9-1548-49af-ab59-9821d8829b08"],
Cell[149610, 3931, 3544, 86, 294, "Input",ExpressionUUID->"ce7dcb6a-44a1-4c70-a7eb-64e2b4b28d1d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153203, 4023, 84, 0, 67, "Section",ExpressionUUID->"ebbf719e-5ee0-4421-b16d-611848a844fe"],
Cell[153290, 4025, 5421, 130, 430, "Input",ExpressionUUID->"6c2a26e1-073c-4564-9d92-fec70e216f24"],
Cell[158714, 4157, 732, 23, 86, "Input",ExpressionUUID->"feedf23b-6062-4115-a89a-513395bf5cda"],
Cell[159449, 4182, 870, 26, 90, "Input",ExpressionUUID->"120f04fa-603a-40b2-9a4d-0834c66193e4"],
Cell[160322, 4210, 901, 28, 90, "Input",ExpressionUUID->"7249ffe0-e0ff-4090-b47a-73d88bc702a1"],
Cell[161226, 4240, 953, 28, 90, "Input",ExpressionUUID->"574a8c9e-fac8-461f-a719-455369a836e1"],
Cell[162182, 4270, 893, 26, 90, "Input",ExpressionUUID->"6487488f-32d5-4d74-8f25-ea881275aa11"],
Cell[163078, 4298, 953, 28, 90, "Input",ExpressionUUID->"2c9fc796-dfb3-489d-87da-2db010e40b0c"],
Cell[164034, 4328, 1015, 30, 90, "Input",ExpressionUUID->"b3e059d0-2180-4b93-87fd-c838685b3c34"],
Cell[165052, 4360, 893, 26, 90, "Input",ExpressionUUID->"f4baaead-93ca-42ae-8908-d431f3f75a87"],
Cell[165948, 4388, 1203, 31, 150, "Input",ExpressionUUID->"627f0f6d-a396-49ea-9c00-842770011df8"],
Cell[167154, 4421, 2036, 53, 150, "Input",ExpressionUUID->"33852ac3-59f7-4abe-8d69-40ecacf56918"],
Cell[169193, 4476, 145, 3, 29, "Input",ExpressionUUID->"dbc4e85a-3db6-4bd5-9bd1-28c08a35e9a3"],
Cell[169341, 4481, 9244, 274, 850, "Input",ExpressionUUID->"248682d9-5f6d-4080-875c-fdd73a591f04"]
}, Open  ]]
}
]
*)

