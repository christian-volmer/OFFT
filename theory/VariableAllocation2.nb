(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59375,       1474]
NotebookOptionsPosition[     56579,       1428]
NotebookOutlinePosition[     56983,       1444]
CellTagsIndexPosition[     56940,       1441]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComplexMultiplicationMatrix", "[", "z_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Re", "[", "z", "]"}], 
       RowBox[{"-", 
        RowBox[{"Im", "[", "z", "]"}]}]},
      {
       RowBox[{"Im", "[", "z", "]"}], 
       RowBox[{"Re", "[", "z", "]"}]}
     }], ")"}]}], ";"}]], "Input",
 CellLabel->
  "In[533]:=",ExpressionUUID->"fd9c7a54-1148-4cce-8b16-fc1448d22b2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckFourierProgram", "[", 
    RowBox[{"program_", ",", "length_"}], "]"}], ":=", 
   RowBox[{"SameQ", "@@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"I", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}]}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"ProgramRun", "[", 
                  RowBox[{"program", ",", 
                   RowBox[{"Upsample", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}], "]"}], ",", "2"}], 
                "]"}]}], ")"}], "&"}], "/@", 
            RowBox[{"IdentityMatrix", "[", "length", "]"}]}], ")"}], "-", 
          RowBox[{"FourierMatrix", "[", "length", "]"}]}], "]"}], "]"}], 
       "]"}], ",", "0"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[534]:=",ExpressionUUID->"9df02e3a-135d-45b5-b987-8f11bd571166"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$TempsAsArray", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "$ModulesTargetPath", "=", 
   "\"\<C:\\\\Users\\\\Christian \
Volmer\\\\Documents\\\\Projekte\\\\offt\\\\offt\\\\src\\\\backend\\\\standard_\
modules\>\""}], ";"}]}], "Input",
 CellLabel->
  "In[535]:=",ExpressionUUID->"6cb62124-bf8d-4d62-b2e7-bd7fd2b5c8c2"],

Cell[CellGroupData[{

Cell["Subroutines", "Section",ExpressionUUID->"fb00b6ec-f5d6-44e1-afee-0dc14bfbcda0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgramTempAllocation", "[", "program_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "length", ",", "temps", ",", "lifetime", ",", "name", ",", "line", ",", 
      "assignTo", ",", "assignFrom", ",", "t", ",", "s"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", "=", 
      RowBox[{"Length", "[", "program", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temps", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"program", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "]"}],
         ",", "_temp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lifetime", "[", "name", "]"}], "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"name", ",", "temps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"lifetime", "[", "assignFrom", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{
              "t", "\[LeftDoubleBracket]", "line", "\[RightDoubleBracket]"}], 
              "=", "3"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"line", "-", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "t", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}], "!=",
               "2"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "t", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}], 
               "=", "1"}], ";", 
              RowBox[{"--", "s"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"lifetime", "[", "assignFrom", "]"}], "=", "t"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"assignFrom", ",", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "program", "\[LeftDoubleBracket]", "line", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", "_temp"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"assignTo", "=", 
         RowBox[{
          RowBox[{
          "program", "\[LeftDoubleBracket]", "line", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"assignTo", ",", "_temp"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"lifetime", "[", "assignTo", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "t", "\[LeftDoubleBracket]", "line", "\[RightDoubleBracket]"}], 
            "=", "2"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"lifetime", "[", "assignTo", "]"}], "=", "t"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"line", ",", 
         RowBox[{"Length", "[", "program", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"temps", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"lifetime", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "temps"}], "}"}]}], "]"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[537]:=",ExpressionUUID->"e1bc0041-ee98-46c4-8799-01b21b478d3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramTempAllocationPlot", "[", "program_", "]"}], ":=", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ProgramTempAllocation", "[", "program", "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"ColorRules", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "->", "White"}], ",", 
        RowBox[{"1", "->", "Black"}], ",", 
        RowBox[{"2", "->", "Red"}], ",", 
        RowBox[{"3", "->", "Green"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[538]:=",ExpressionUUID->"9d599482-2ddc-423c-99c0-787eeec0b2ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramPrintInfo", "[", "program_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "length", ",", "numberOfInputs", ",", "temps", ",", "numberOfOutputs", 
       ",", "maxAllocation"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", "program", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numberOfInputs", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"program", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
          "]"}], ",", "_in"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"temps", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"program", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
          "]"}], ",", "_temp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numberOfOutputs", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"program", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
          "]"}], ",", "_out"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"maxAllocation", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Total", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ProgramTempAllocation", "[", "program", "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "|", "3"}], ")"}], "->", "1"}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Number of instructions:   \>\"", ",", "length"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Number of inputs:         \>\"", ",", "numberOfInputs"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Number of outputs:        \>\"", ",", "numberOfOutputs"}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Number of temporaries:    \>\"", ",", 
        RowBox[{"Length", "[", "temps", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Maximum live temporaries: \>\"", ",", "maxAllocation"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[539]:=",ExpressionUUID->"2240ca12-1998-4860-b54b-b5fc2f4759fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramRun", "[", 
    RowBox[{"program_", ",", "inputs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "numberOfOutputs", ",", "\[IndentingNewLine]", "memory", ",", "i", ",", 
       "line"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberOfOutputs", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"program", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
          "]"}], ",", "_out"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"memory", "[", "#", "]"}], "=", "Indeterminate"}], ")"}], 
        "&"}], "/@", 
       RowBox[{"Union", "[", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"memory", "[", 
          RowBox[{"temp", "[", 
           RowBox[{"i", "-", "1"}], "]"}], "]"}], "=", 
         RowBox[{
         "inputs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "inputs", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"memory", "[", 
           RowBox[{
           "line", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"memory", "/@", 
             RowBox[{
             "line", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
             ")"}], ".", 
           RowBox[{
           "line", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}],
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"line", ",", "program"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"memory", "[", 
         RowBox[{"out", "[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numberOfOutputs"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[540]:=",ExpressionUUID->"fe160364-c083-4b95-b677-076c1fe426ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramRemoveTrivialOperations", "[", "program_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"p", ",", "line"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"line", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", "program"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"line", "<", 
           RowBox[{"Length", "[", "p", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{
               "p", "\[LeftDoubleBracket]", "line", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"_temp", ",", 
                 RowBox[{"{", "_", "}"}], ",", 
                 RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"p", "=", 
               RowBox[{"p", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "p", "\[LeftDoubleBracket]", "line", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "->", 
                  RowBox[{
                   RowBox[{
                   "p", "\[LeftDoubleBracket]", "line", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                 "}"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"p", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"p", ",", "line"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"++", "line"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{"line", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "p"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[541]:=",ExpressionUUID->"521129fe-df46-4153-8a72-a1fbf1f09ede"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramReuseTemporaries", "[", "program_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "p", ",", "temps", ",", "allocation", ",", "line", ",", "tempLookup", 
       ",", "i", ",", "dest", ",", "src", ",", "destAlloc", ",", "srcAlloc", 
       ",", "free"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", "program"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"temps", ",", "allocation"}], "}"}], "=", 
       RowBox[{"ProgramTempAllocation", "[", "program", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allocation", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"allocation", "/.", 
         RowBox[{"{", 
          RowBox[{"2", "->", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tempLookup", "[", 
          RowBox[{
          "temps", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "temps", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"dest", "=", 
            RowBox[{
             RowBox[{
             "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"dest", ",", "_temp"}], "]"}]}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dest", "=", 
            RowBox[{"tempLookup", "[", "dest", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"src", "=", 
            RowBox[{
             RowBox[{
             "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"src", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"src", ",", 
              RowBox[{"temps", "\[LeftDoubleBracket]", 
               RowBox[{";;", "dest"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"src", "=", 
            RowBox[{"tempLookup", "/@", "src"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"destAlloc", "=", 
            RowBox[{
            "allocation", "\[LeftDoubleBracket]", "dest", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"srcAlloc", "=", 
            RowBox[{
            "allocation", "\[LeftDoubleBracket]", "src", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"free", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"srcAlloc", ".", "destAlloc"}], ",", "0"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "free", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"free", "=", 
               RowBox[{"src", "\[LeftDoubleBracket]", 
                RowBox[{"First", "[", "free", "]"}], 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "allocation", "\[LeftDoubleBracket]", "free", 
                "\[RightDoubleBracket]"}], "+=", 
               RowBox[{
               "allocation", "\[LeftDoubleBracket]", "dest", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "allocation", "\[LeftDoubleBracket]", "dest", 
                "\[RightDoubleBracket]"}], "*=", "0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"p", "=", 
               RowBox[{"p", "/.", 
                RowBox[{
                 RowBox[{
                 "temps", "\[LeftDoubleBracket]", "dest", 
                  "\[RightDoubleBracket]"}], "->", 
                 RowBox[{
                 "temps", "\[LeftDoubleBracket]", "free", 
                  "\[RightDoubleBracket]"}]}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "program", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "program", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "p"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[542]:=",ExpressionUUID->"eb7a96ec-c2a6-4cd5-8a67-849b54abf890"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramReindexTemporaries", "[", "program_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "allTemps", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allTemps", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "program", "]"}], ",", "_temp"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"program", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"allTemps", "->", 
         RowBox[{"temp", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "allTemps", "]"}], "]"}], "-", "1"}], 
           ")"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[543]:=",ExpressionUUID->"d12992a0-f469-4bf6-8475-8046f75f8b67"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Funktioniert", " ", "nicht", " ", 
     RowBox[{"richtig", ".", " ", "Knallt"}], " ", "bei", " ", 
     RowBox[{"Fft", "[", "2", "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ProgramMoveOutputsUp", "[", "program_", "]"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "p", ",", "outputs", ",", "name", ",", "parents", ",", "output", ",", 
        "i", ",", "j", ",", "line", ",", "earliestInsertionPoint"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", "program"}], ";", "\[IndentingNewLine]", 
       RowBox[{"outputs", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"program", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"name_out", ",", "_", ",", "_"}], "}"}], ":>", 
            "name"}]}], "]"}], "\[LeftDoubleBracket]", "All", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"earliestInsertionPoint", "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{"p", ",", 
               RowBox[{"{", 
                RowBox[{"output", ",", "_", ",", "_"}], "}"}]}], "]"}], "]"}],
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"line", "=", 
           RowBox[{
           "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"parents", "=", 
           RowBox[{
           "line", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"j", "=", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"p", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Alternatives", "@@", "parents"}], ",", "_", ",", 
                  "_"}], "}"}]}], "]"}], "]"}], ",", 
             "earliestInsertionPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"earliestInsertionPoint", "=", 
           RowBox[{"j", "+", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"p", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"p", ",", "line", ",", 
             RowBox[{"j", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"output", ",", "outputs"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "p"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]], "Input",
 CellLabel->
  "In[544]:=",ExpressionUUID->"64c9ab31-3df7-40d0-a24c-66dab7b9014d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Program generation", "Section",ExpressionUUID->"4a22e3a2-5a41-48cd-a0a7-6b3b51fa3a6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"in", ",", "temp", ",", "out"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"in", ",", "temp", ",", "out"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", "temp", ",", "out"}], "}"}], ",", 
    RowBox[{"{", "NHoldAll", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"in", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"out", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"in", ",", "temp", ",", "out"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[545]:=",ExpressionUUID->"a1ce0fec-d34c-4e96-a68b-87ffc9da2fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramGenerateForFft", "[", "length_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "matrices", ",", "z", ",", "signs", ",", "i", ",", "r", ",", "m", ",", 
       "stepInputRegs", ",", "nextAvailableReg", ",", "program", ",", "step", 
       ",", "positions"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", "\"\<Matrices 1...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"matrices", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"Fft", "[", "length", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrices", "=", 
       RowBox[{"RootReduce", "[", 
        RowBox[{"ArrayFlatten", "/@", 
         RowBox[{"Replace", "[", 
          RowBox[{"matrices", ",", 
           RowBox[{"z_", ":>", 
            RowBox[{"ComplexMultiplicationMatrix", "[", "z", "]"}]}], ",", 
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"Heads", "->", "False"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Matrices 2...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"signs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Except", "[", "0", "]"}]}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@", 
            RowBox[{
            "matrices", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"signs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"PossibleZeroQ", "[", 
                 RowBox[{"Re", "[", "#", "]"}], "]"}]}], ",", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{"Sign", "[", 
                 RowBox[{"Re", "[", "#", "]"}], "]"}], "]"}], ",", 
               RowBox[{"FullSimplify", "[", 
                RowBox[{"Sign", "[", 
                 RowBox[{"Im", "[", "#", "]"}], "]"}], "]"}]}], "]"}], "&"}], 
            "/@", "signs"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "matrices", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
            "*=", "signs"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"matrices", "\[LeftDoubleBracket]", 
            RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"matrices", "\[LeftDoubleBracket]", 
               RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "]"}], "*",
              "signs"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "matrices", "]"}], ",", "2", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<RootReduce...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"matrices", "=", 
       RowBox[{"RootReduce", "[", "matrices", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Stepping...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"stepInputRegs", "=", 
       RowBox[{"temp", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"2", "length"}], "]"}], "-", "1"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextAvailableReg", "=", 
       RowBox[{"2", "length"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"program", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"step", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"positions", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"r", ",", 
                    RowBox[{"Except", "[", "0", "]"}], ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"temp", "[", 
                   RowBox[{"nextAvailableReg", "++"}], "]"}], ",", 
                  RowBox[{
                  "stepInputRegs", "\[LeftDoubleBracket]", "positions", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "r", "\[LeftDoubleBracket]", "positions", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"r", ",", "m"}], "}"}]}], "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"stepInputRegs", "=", 
             RowBox[{"step", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", "step"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"Reverse", "@", "matrices"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "length"}], ";;"}], ",", "1"}], 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{"Array", "[", 
        RowBox[{"out", ",", 
         RowBox[{"2", "length"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "PrintTemporary", "[", "\"\<RemoveTrivialOperations...\>\"", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"program", "=", 
       RowBox[{"ProgramRemoveTrivialOperations", "[", "program", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"program", "=", 
         RowBox[{"ProgramMoveOutputsUp", "[", "program", "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<ReuseTemporaries...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"program", "=", 
       RowBox[{"ProgramReuseTemporaries", "[", "program", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<ReindexTemporaries...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"program", "=", 
       RowBox[{"ProgramReindexTemporaries", "[", "program", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<CheckFourierProgram...\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"CheckFourierProgram", "[", 
         RowBox[{"program", ",", "length"}], "]"}], ",", 
        "\[IndentingNewLine]", "program", ",", "\[IndentingNewLine]", 
        "$Failed"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[552]:=",ExpressionUUID->"216fe5f1-fe57-41dc-b559-7520a5917b54"]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ code generation", "Section",ExpressionUUID->"ae218595-bba2-445e-9c3c-ced48e9ffe23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numberToString", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegerQ", "[", "n", "]"}], "&&", 
       RowBox[{"n", "<", "0"}]}], ",", 
      RowBox[{"\"\<-\>\"", "<>", 
       RowBox[{"IntegerString", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegerQ", "[", "n", "]"}], "&&", 
       RowBox[{"n", ">=", "0"}]}], ",", 
      RowBox[{"IntegerString", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
      "True", ",", 
      RowBox[{"\"\<valueT(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"CForm", "[", 
         RowBox[{"N", "[", 
          RowBox[{"n", ",", "20"}], "]"}], "]"}], "]"}]}]}], "]"}], "<>", 
    "\"\<)\>\""}]}], ";"}]], "Input",
 CellLabel->
  "In[553]:=",ExpressionUUID->"1816c8e3-6798-4580-8ddf-2592f1a5f18b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tempVariableString", "[", "i_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"$TempsAsArray", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<t[\>\"", "<>", 
      RowBox[{"IntegerString", "[", "i", "]"}], "<>", "\"\<]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<t\>\"", "<>", 
      RowBox[{"IntegerString", "[", "i", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[554]:=",ExpressionUUID->"e19ec0ca-1b7e-477f-adc5-586bf01f747c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhsString", "[", 
    RowBox[{
     RowBox[{"temps", ":", 
      RowBox[{"{", "__temp", "}"}]}], ",", 
     RowBox[{"coeffs", ":", 
      RowBox[{"{", "__", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"t", ",", "mults", ",", "ops"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "temps", "]"}], ">", "1"}], "&&", 
        RowBox[{"Equal", "@@", 
         RowBox[{"Abs", "[", "coeffs", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
          "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "!=", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numberToString", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
          "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "]"}], "<>", "\"\< * (\>\"", "<>", 
        RowBox[{"rhsString", "[", 
         RowBox[{"temps", ",", 
          RowBox[{"coeffs", "/", 
           RowBox[{"Abs", "[", 
            RowBox[{
            "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], "<>", "\"\<)\>\""}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"temps", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"temp", "[", "a_", "]"}], ":>", 
            RowBox[{"tempVariableString", "[", "a", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mults", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#", "==", "1"}], ",", "\"\<\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"#", "==", 
              RowBox[{"-", "1"}]}], ",", "\"\<\>\"", ",", 
             "\[IndentingNewLine]", "True", ",", 
             RowBox[{
              RowBox[{"numberToString", "[", 
               RowBox[{"Abs", "[", "#", "]"}], "]"}], "<>", "\"\< * \>\""}]}],
             "\[IndentingNewLine]", "]"}], "&"}], "/@", "coeffs"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ops", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "<", "0"}], ",", "\"\< - \>\"", ",", 
             "\"\< + \>\""}], "]"}], "&"}], "/@", "coeffs"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "ops", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "coeffs", "]"}], "<", "0"}], ",", 
           "\"\<-\>\"", ",", "\"\<\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"ops", ",", " ", "mults", ",", "t"}], "}"}], "]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[555]:=",ExpressionUUID->"691c7ca6-f2e4-4d01-96ef-f0db5a7a545d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "template", "=", 
   "\"\<\n//          Copyright Christian Volmer 2022, 2023.\n// Distributed \
under the Boost Software License, Version 1.0.\n//    (See accompanying file \
LICENSE_1_0.txt or copy at\n//          \
https://www.boost.org/LICENSE_1_0.txt)\n\n#include \\\"../standard_module.h\\\
\"\n\nnamespace offt {\nnamespace backend {\n\n/*\n\\tNumber of additions     \
  : <additionCount>\n\\tNumber of multiplications : <multiplicationCount>\n*/\
\n\ntemplate<> StandardModuleComplexity const StandardModule<float, \
<length>>::Complexity = { <additionCount>, <multiplicationCount> };\n\
template<> StandardModuleComplexity const StandardModule<double, \
<length>>::Complexity = { <additionCount>, <multiplicationCount> };\n\n\
template<typename valueT>\nstatic void ComputeCore(Phasors<valueT> const \
&phasors, valueT *pReal, valueT *pImag, ptrdiff_t stride, size_t \
twiddleStart, size_t twiddleIncrement)\n{\n\\t<temps>\n\n\\t<twiddle>\n\n\
\\t<computations>\n}\n\ntemplate<> void StandardModule<float, \
<length>>::Compute(float *pReal, float *pImag, ptrdiff_t stride, size_t \
twiddleStart, size_t twiddleIncrement) const\n{\n\\tComputeCore(mPhasors, \
pReal, pImag, stride, twiddleStart, twiddleIncrement);\n}\n\ntemplate<> void \
StandardModule<double, <length>>::Compute(double *pReal, double *pImag, \
ptrdiff_t stride, size_t twiddleStart, size_t twiddleIncrement) const\n{\n\
\\tComputeCore(mPhasors, pReal, pImag, stride, twiddleStart, \
twiddleIncrement);\n}\n\n}\n}\n\>\""}], ";"}]], "Input",
 CellLabel->
  "In[556]:=",ExpressionUUID->"fdfb2057-9c6a-4f2f-a514-b089f63e47ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenerateCppCode", "[", 
    RowBox[{"length_", ",", "program_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "coeffs", ",", "i", ",", "temps", ",", 
       "twiddle", ",", "computations", ",", "additionCount", ",", 
       "multiplicationCount"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
       "$TempsAsArray", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temps", "=", 
          RowBox[{"{", 
           RowBox[{"\"\<valueT t[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"Union", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "program", "]"}], ",", 
                 RowBox[{
                  RowBox[{"temp", "[", "a_", "]"}], ":>", "a"}]}], "]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<];\>\""}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"twiddle", "=", 
          RowBox[{"{", 
           RowBox[{
           "\"\<phasors.Twiddle(t, pReal, pImag, stride, twiddleStart, \
twiddleIncrement, \>\"", "<>", 
            RowBox[{"ToString", "[", "length", "]"}], "<>", "\"\<);\>\""}], 
           "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temps", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<t\>\"", ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"IntegerString", "/@", 
              RowBox[{"Union", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "program", "]"}], ",", 
                 RowBox[{
                  RowBox[{"temp", "[", "a_", "]"}], ":>", "a"}]}], "]"}], 
               "]"}]}]}], ",", 
            RowBox[{"UpTo", "[", "10", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"temps", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<valueT \>\"", ",", 
              RowBox[{"Riffle", "[", 
               RowBox[{"#", ",", "\"\<, \>\""}], "]"}], ",", "\"\<;\>\""}], 
             "]"}], "&"}], "/@", "temps"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"twiddle", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<phasors.Multiply(\>\"", "<>", 
                  RowBox[{"tempVariableString", "[", 
                   RowBox[{"2", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"tempVariableString", "[", 
                  RowBox[{
                   RowBox[{"2", "i"}], "+", "1"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<pReal[\>\"", "<>", 
                  RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
                  "\"\< * stride]\>\""}], ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<pImag[\>\"", "<>", 
                  RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
                  "\"\< * stride]\>\""}], ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<twiddleStart + \>\"", "<>", 
                  RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
                  "\"\< * twiddleIncrement);\>\""}]}], "\[IndentingNewLine]", 
                "}"}], ",", "\"\<, \>\""}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"length", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"computations", "=", 
       RowBox[{"program", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"temp", "[", "a_", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"temp", "[", "a_", "]"}], ",", "b__temp"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "c_", ",", "coeffs___"}], "}"}]}], "}"}], "/;", 
            RowBox[{"c", ">", "0"}]}], ":>", 
           RowBox[{
            RowBox[{"tempVariableString", "[", "a", "]"}], "<>", 
            "\"\< += \>\"", "<>", 
            RowBox[{"rhsString", "[", 
             RowBox[{
              RowBox[{"{", "b", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "coeffs"}], "}"}]}], "]"}], "<>", 
            "\"\<;\>\""}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"temp", "[", "a_", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"temp", "[", "a_", "]"}], ",", "b__temp"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "c_", ",", "coeffs___"}], "}"}]}], "}"}], "/;", 
            RowBox[{"c", "<", "0"}]}], ":>", 
           RowBox[{
            RowBox[{"tempVariableString", "[", "a", "]"}], "<>", 
            "\"\< -= \>\"", "<>", 
            RowBox[{"rhsString", "[", 
             RowBox[{
              RowBox[{"{", "b", "}"}], ",", 
              RowBox[{"-", 
               RowBox[{"{", 
                RowBox[{"c", ",", "coeffs"}], "}"}]}]}], "]"}], "<>", 
            "\"\<;\>\""}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp", "[", "a_", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"temp", "[", "a_", "]"}], "}"}], ",", 
             RowBox[{"{", "c_", "}"}]}], "}"}], ":>", 
           RowBox[{
            RowBox[{"tempVariableString", "[", "a", "]"}], "<>", 
            "\"\< *= \>\"", "<>", 
            RowBox[{"numberToString", "[", "c", "]"}], "<>", "\"\<;\>\""}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"temp", "[", "a_", "]"}], ",", 
             RowBox[{"{", "b__temp", "}"}], ",", "coeffs_"}], "}"}], ":>", 
           RowBox[{
            RowBox[{"tempVariableString", "[", "a", "]"}], "<>", 
            "\"\< = \>\"", "<>", 
            RowBox[{"rhsString", "[", 
             RowBox[{
              RowBox[{"{", "b", "}"}], ",", "coeffs"}], "]"}], "<>", 
            "\"\<;\>\""}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"out", "[", "a_", "]"}], ",", 
             RowBox[{"{", "b__temp", "}"}], ",", "coeffs_"}], "}"}], ":>", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", "a", "]"}], ",", "\"\<pReal[\>\"", ",", 
              "\"\<pImag[\>\""}], "]"}], "<>", 
            RowBox[{"IntegerString", "[", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "-", "1"}], ")"}], "/", "2"}], "]"}], "]"}], 
            "<>", "\"\< * stride] = \>\"", "<>", 
            RowBox[{"rhsString", "[", 
             RowBox[{
              RowBox[{"{", "b", "}"}], ",", "coeffs"}], "]"}], "<>", 
            "\"\<;\>\""}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"additionCount", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Length", "/@", 
          RowBox[{"program", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], "-", "1"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"multiplicationCount", "=", 
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Union", "/@", 
           RowBox[{"Abs", "[", 
            RowBox[{"program", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Except", "[", "1", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"template", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<<length>\>\"", "->", 
           RowBox[{"IntegerString", "[", "length", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<<additionCount>\>\"", "->", 
           RowBox[{"IntegerString", "[", "additionCount", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<<multiplicationCount>\>\"", "->", 
           RowBox[{"IntegerString", "[", "multiplicationCount", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<temps>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "temps"}], ",", 
              "\"\<\\n\>\""}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<twiddle>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "twiddle"}], 
              ",", "\"\<\\n\>\""}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<computations>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", 
               "computations"}], ",", "\"\<\\n\>\""}], "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[557]:=",ExpressionUUID->"777cfdb2-2ca3-40e0-b14b-1515c60150d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main", "Section",ExpressionUUID->"dd5fb287-da4c-42ef-8eb1-c2dd37616c10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"length", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"program", "=", 
   RowBox[{"ProgramGenerateForFft", "[", "length", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProgramPrintInfo", "[", "program", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ProgramTempAllocationPlot", "[", "program", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "\"\< <-- \>\""}], "}"}], ",", 
          RowBox[{"Riffle", "@@", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2"}], "}"}], "\[RightDoubleBracket]"}]}]}], 
         "]"}], "&"}], "/@", "program"}], ",", 
      RowBox[{"Alignment", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Right", ",", "Left"}], "}"}], "}"}], ",", "Baseline"}], 
        "}"}]}]}], "]"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"GenerateCppCode", "[", 
    RowBox[{"length", ",", "program"}], "]"}], "*)"}]}]}], "Input",
 CellLabel->
  "In[558]:=",ExpressionUUID->"796d7dcf-b1c2-4b88-a941-fab3aa8b2a7c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"programs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PrintTemporary", "[", "length", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ProgramGenerateForFft", "[", "length", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"length", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", "32"}], "]"}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{"64", ",", "128"}], "}"}]}], "*)"}], "]"}]}], "}"}]}], 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellLabel->
  "In[561]:=",ExpressionUUID->"12ca173a-8391-4182-ad2c-53fcd17d5eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$ModulesTargetPath", ",", 
          RowBox[{"\"\<module_\>\"", "<>", 
           RowBox[{"IntegerString", "[", 
            RowBox[{
            "program", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}], "<>", "\"\<.cpp\>\""}]}], "}"}], "]"}], ",", 
       RowBox[{"GenerateCppCode", "[", 
        RowBox[{
         RowBox[{
         "program", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
         "program", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}], ",", "\"\<Text\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"program", ",", "programs"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellLabel->
  "In[562]:=",ExpressionUUID->"9cdeb73a-0e67-4fd5-8b8e-da484949e6ea"]
}, Open  ]]
},
WindowSize->{1284, 981},
WindowMargins->{{153, Automatic}, {Automatic, 155}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e6646469-b8ab-4583-aaf5-28c39edddcd7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 440, 14, 45, "Input",ExpressionUUID->"fd9c7a54-1148-4cce-8b16-fc1448d22b2d"],
Cell[1001, 36, 1377, 37, 50, "Input",ExpressionUUID->"9df02e3a-135d-45b5-b987-8f11bd571166"],
Cell[2381, 75, 381, 10, 50, "Input",ExpressionUUID->"6cb62124-bf8d-4d62-b2e7-bd7fd2b5c8c2"],
Cell[CellGroupData[{
Cell[2787, 89, 85, 0, 67, "Section",ExpressionUUID->"fb00b6ec-f5d6-44e1-afee-0dc14bfbcda0"],
Cell[2875, 91, 4562, 112, 670, "Input",ExpressionUUID->"e1bc0041-ee98-46c4-8799-01b21b478d3c"],
Cell[7440, 205, 653, 17, 29, "Input",ExpressionUUID->"9d599482-2ddc-423c-99c0-787eeec0b2ab"],
Cell[8096, 224, 2961, 68, 350, "Input",ExpressionUUID->"2240ca12-1998-4860-b54b-b5fc2f4759fd"],
Cell[11060, 294, 2748, 72, 350, "Input",ExpressionUUID->"fe160364-c083-4b95-b677-076c1fe426ad"],
Cell[13811, 368, 2592, 62, 370, "Input",ExpressionUUID->"521129fe-df46-4153-8a72-a1fbf1f09ede"],
Cell[16406, 432, 5547, 132, 690, "Input",ExpressionUUID->"eb7a96ec-c2a6-4cd5-8a67-849b54abf890"],
Cell[21956, 566, 912, 25, 90, "Input",ExpressionUUID->"d12992a0-f469-4bf6-8475-8046f75f8b67"],
Cell[22871, 593, 3290, 76, 490, "Input",ExpressionUUID->"64c9ab31-3df7-40d0-a24c-66dab7b9014d"]
}, Closed]],
Cell[CellGroupData[{
Cell[26198, 674, 92, 0, 53, "Section",ExpressionUUID->"4a22e3a2-5a41-48cd-a0a7-6b3b51fa3a6d"],
Cell[26293, 676, 985, 31, 150, "Input",ExpressionUUID->"a1ce0fec-d34c-4e96-a68b-87ffc9da2fca"],
Cell[27281, 709, 7945, 178, 1110, "Input",ExpressionUUID->"216fe5f1-fe57-41dc-b559-7520a5917b54"]
}, Closed]],
Cell[CellGroupData[{
Cell[35263, 892, 93, 0, 53, "Section",ExpressionUUID->"ae218595-bba2-445e-9c3c-ced48e9ffe23"],
Cell[35359, 894, 916, 24, 90, "Input",ExpressionUUID->"1816c8e3-6798-4580-8ddf-2592f1a5f18b"],
Cell[36278, 920, 533, 13, 90, "Input",ExpressionUUID->"e19ec0ca-1b7e-477f-adc5-586bf01f747c"],
Cell[36814, 935, 3455, 88, 410, "Input",ExpressionUUID->"691c7ca6-f2e4-4d01-96ef-f0db5a7a545d"],
Cell[40272, 1025, 1636, 26, 850, "Input",ExpressionUUID->"fdfb2057-9c6a-4f2f-a514-b089f63e47ed"],
Cell[41911, 1053, 11108, 265, 890, "Input",ExpressionUUID->"777cfdb2-2ca3-40e0-b14b-1515c60150d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53056, 1323, 78, 0, 67, "Section",ExpressionUUID->"dd5fb287-da4c-42ef-8eb1-c2dd37616c10"],
Cell[53137, 1325, 1490, 44, 130, "Input",ExpressionUUID->"796d7dcf-b1c2-4b88-a941-fab3aa8b2a7c"],
Cell[54630, 1371, 860, 24, 110, "Input",ExpressionUUID->"12ca173a-8391-4182-ad2c-53fcd17d5eed"],
Cell[55493, 1397, 1070, 28, 110, "Input",ExpressionUUID->"9cdeb73a-0e67-4fd5-8b8e-da484949e6ea"]
}, Open  ]]
}
]
*)

