(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84353,       2037]
NotebookOptionsPosition[     79830,       1956]
NotebookOutlinePosition[     80272,       1973]
CellTagsIndexPosition[     80229,       1970]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Fourier", ",", "InverseFourier", ",", "FourierMatrix"}], "}"}], 
    ",", 
    RowBox[{"FourierParameters", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"623eb154-4eb0-47a7-9f6c-1d131fc34155"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$ModulesTargetPath", "=", 
   "\"\<C:\\\\Users\\\\Christian \
Volmer\\\\Documents\\\\Projekte\\\\offt\\\\offt\\\\src\\\\backend\\\\standard_\
modules\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ModuleSizes", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"d3f85e32-929e-4463-8351-083d39e94f66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<FftDefinitionsReIm.wl\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"73f4855c-af29-4fb0-ba6e-2fd2b19fef39"],

Cell[CellGroupData[{

Cell["Programs", "Section",ExpressionUUID->"2e5cf9ae-f3de-4901-a2e5-a392c5a535e7"],

Cell[CellGroupData[{

Cell["Basics", "Subsection",ExpressionUUID->"a8e26c4e-d241-4d7e-af60-f30958993008"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"Program", ",", "InVar", ",", "OutVar", ",", "TempVar"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Program", ",", "InVar", ",", "OutVar", ",", "TempVar"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Program", "::", "usage"}], "=", "\"\<\>\""}], ";", 
  RowBox[{
   RowBox[{"InVar", "::", "usage"}], "=", "\"\<\>\""}], ";", 
  RowBox[{
   RowBox[{"OutVar", "::", "usage"}], "=", "\"\<\>\""}], ";", 
  RowBox[{
   RowBox[{"TempVar", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"Program", ",", "InVar", ",", "OutVar", ",", "TempVar"}], "]"}], 
  ";"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"a6ef962d-fb68-41b3-9b78-f924bb7ea931"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramForLength", "Subsection",ExpressionUUID->"834b30df-0b91-4bda-bc3e-50dbbb6ab82f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProgramForLength", "[", "length_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "transformationList", ",", "\[IndentingNewLine]", "graph", ",", 
      "\[IndentingNewLine]", "matrix", ",", "\[IndentingNewLine]", 
      "variables"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"transformationList", "=", 
      RowBox[{"List", "@@", 
       RowBox[{"FftReal", "[", "length", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Array", "[", 
           RowBox[{"matrix", ",", 
            RowBox[{"Length", "[", "transformationList", "]"}]}], "]"}]}], 
         "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"matrix", "[", "i_", "]"}], ":>", 
          RowBox[{
          "transformationList", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "length"}], ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "graph", "]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}], ",", "graph"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"graph", "\[Transpose]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "length"}], ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "graph", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "]"}]}], "]"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"variables", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"InVar", ",", 
          RowBox[{"2", "length"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Array", "[", 
         RowBox[{"TempVar", ",", 
          RowBox[{
           RowBox[{"Length", "[", "graph", "]"}], "-", 
           RowBox[{"4", "length"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Array", "[", 
         RowBox[{"OutVar", ",", 
          RowBox[{"2", "length"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Program", "[", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
        RowBox[{"\"\<Graph\>\"", "->", "graph"}], ",", 
        RowBox[{"\"\<Variables\>\"", "->", "variables"}]}], "|>"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"bc046129-b35b-48f2-a465-04c8c2fdf438"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramRun", "Subsection",ExpressionUUID->"c7a5add4-3778-45e9-8db2-918dd6a182d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ProgramRun", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgramRun", "[", 
   RowBox[{"program_Program", ",", "input_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Length\>\""}], "\[RightDoubleBracket]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"variables", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Variables\>\""}], "\[RightDoubleBracket]"}]}], 
      ",", "\[IndentingNewLine]", "memory", ",", "\[IndentingNewLine]", 
      "inputReIm", ",", "line", ",", "\[IndentingNewLine]", "result"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "input", "]"}], "=!=", "length"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"memory", "=", "variables"}], ";", "\[IndentingNewLine]", 
     RowBox[{"inputReIm", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ReIm", "[", "input", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"memory", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"memory", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"InVar", "[", "i_", "]"}], ":>", 
           RowBox[{
           "inputReIm", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"_", "->", "0"}]}], "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "memory", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"memory", ".", 
          RowBox[{
          "graph", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
         ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"2", "length"}], "+", "1"}], ",", 
         RowBox[{"Length", "[", "graph", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"OutVar", ",", 
         RowBox[{"2", "length"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "->", "memory"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Complex", "@@@", 
      RowBox[{"Partition", "[", 
       RowBox[{"result", ",", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"245ee954-ce98-49f0-bd4f-0d50e5f056b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramCheckFft", "Subsection",ExpressionUUID->"3f4b3124-271e-4d90-a8cc-9c2b0370b7b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ProgramCheckFft", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProgramCheckFft", "[", "program_Program", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ProgramRun", "[", 
            RowBox[{"program", ",", "#"}], "]"}], "-", 
           RowBox[{"Fourier", "[", "#", "]"}]}], ",", "1*^-6"}], "]"}], "]"}],
        "===", 
       RowBox[{"{", "0", "}"}]}], ")"}], "&"}], "[", 
    RowBox[{"RandomComplex", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "-", "I"}], ",", 
        RowBox[{"1", "+", "I"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
       "program", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", "\"\<Length\>\"", "\[RightDoubleBracket]"}]}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"7364f4e8-7abb-4e68-99a6-9b3a7169641f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramPlot", "Subsection",ExpressionUUID->"b35eb0f9-2459-4fca-9384-04a6fc622a19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ProgramPlot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgramPlot", "[", "program_Program", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"graph", "=", 
       RowBox[{
        RowBox[{
        "program", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", "\"\<Graph\>\"", "\[RightDoubleBracket]"}]}], 
      ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MatrixPlot", "[", 
     RowBox[{
      RowBox[{"graph", "+", 
       RowBox[{"x", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "graph", "]"}], "]"}]}]}], ",", 
      RowBox[{"MaxPlotPoints", "->", "Infinity"}], ",", 
      RowBox[{"Mesh", "->", "All"}], ",", 
      RowBox[{"ColorRules", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "->", "White"}], ",", 
         RowBox[{"1", "->", "Black"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "->", "Green"}], ",", 
         RowBox[{"x", "->", "Gray"}], ",", 
         RowBox[{
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "x"}], "]"}]}], "&"}], ")"}]}], "->", 
          "Yellow"}], ",", 
         RowBox[{"_", "->", "Red"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "600"}], ",", 
      RowBox[{"FrameTicks", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "#", ",", "#", ",", "#"}], "}"}], "&"}], "[", 
         RowBox[{"Range", "[", 
          RowBox[{"5", ",", 
           RowBox[{"Length", "[", "graph", "]"}], ",", "5"}], "]"}], "]"}], 
        ")"}]}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"97dacd3f-54a4-4d81-8dbf-3bcf0aa9a790"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramMoveRight", "Subsection",ExpressionUUID->"67bf655c-d309-447a-8229-06da12c6db96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ProgramMoveRight", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProgramMoveRight", "[", "program_Program", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Length\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"variables", "=", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Variables\>\""}], "\[RightDoubleBracket]"}]}],
        ",", "\[IndentingNewLine]", "start", ",", "stop", ",", 
       "\[IndentingNewLine]", "perm", ",", "before", ",", "current", ",", 
       "\[IndentingNewLine]", "lastFirst"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lastFirst", "=", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[RightDoubleBracket]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"start", "=", 
       RowBox[{
        RowBox[{"2", "length"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stop", "=", 
       RowBox[{"Length", "[", "graph", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"current", "=", "graph"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"before", "=", "current"}], ";", "\[IndentingNewLine]", 
        RowBox[{"perm", "=", 
         RowBox[{"start", "-", "1", "+", 
          RowBox[{"OrderingBy", "[", 
           RowBox[{
            RowBox[{"current", "\[LeftDoubleBracket]", 
             RowBox[{"start", ";;", "stop"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"lastFirst", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Except", "[", "0", "]"}], ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}], "]"}], 
             "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"perm", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"start", "-", "1"}], "]"}], ",", "perm", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"stop", "+", "1"}], ",", 
             RowBox[{"Length", "[", "graph", "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"current", "=", 
         RowBox[{"current", "\[LeftDoubleBracket]", 
          RowBox[{"perm", ",", "perm"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"variables", "=", 
         RowBox[{
         "variables", "\[LeftDoubleBracket]", "perm", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"current", "=!=", "before"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Program", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
         RowBox[{"\"\<Graph\>\"", "->", "current"}], ",", 
         RowBox[{"\"\<Variables\>\"", "->", "variables"}]}], "|>"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"2bbdf6cc-04ac-4fa2-82c8-6a3074864b86"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProgramDeleteIdentities", "Subsection",ExpressionUUID->"4580373f-701d-4005-9644-bd2840b42706"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "ProgramDeleteIdentities", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProgramDeleteIdentities", "[", "program_Program", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Length\>\""}], "\[RightDoubleBracket]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"variables", "=", 
       RowBox[{"program", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Variables\>\""}], "\[RightDoubleBracket]"}]}], 
      ",", "\[IndentingNewLine]", "lines", ",", "\[IndentingNewLine]", "i", 
      ",", "p"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", 
      RowBox[{
       RowBox[{"2", "length"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "graph", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "<=", 
        RowBox[{
         RowBox[{"Length", "[", "lines", "]"}], "-", 
         RowBox[{"2", "length"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"graph", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
              "lines", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", "lines"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"Except", "[", "0", "]"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "p", "]"}], "===", "1"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ";", 
             RowBox[{
              RowBox[{"graph", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{
                "lines", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "lines", "\[LeftDoubleBracket]", "p", 
                 "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "===",
               "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"graph", "\[LeftDoubleBracket]", 
             RowBox[{"lines", ",", 
              RowBox[{
              "lines", "\[LeftDoubleBracket]", "p", 
               "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "+=", 
            RowBox[{"graph", "\[LeftDoubleBracket]", 
             RowBox[{"lines", ",", 
              RowBox[{
              "lines", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"variables", "\[LeftDoubleBracket]", 
                RowBox[{
                "lines", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
               "_OutVar"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"variables", "\[LeftDoubleBracket]", 
               RowBox[{
               "lines", "\[LeftDoubleBracket]", "p", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"variables", "\[LeftDoubleBracket]", 
               RowBox[{
               "lines", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lines", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"lines", ",", 
              RowBox[{"{", 
               RowBox[{
               "lines", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"++", "i"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Program", "[", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
        RowBox[{"\"\<Graph\>\"", "->", 
         RowBox[{"graph", "\[LeftDoubleBracket]", 
          RowBox[{"lines", ",", "lines"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"\"\<Variables\>\"", "->", 
         RowBox[{
         "variables", "\[LeftDoubleBracket]", "lines", 
          "\[RightDoubleBracket]"}]}]}], "|>"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"98bade53-8459-490f-b2d7-bbbb90d1dbe0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Traversal", "Section",ExpressionUUID->"3d73821e-1c28-42b2-82d8-a87bc1de86f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CollectChildren", "[", 
    RowBox[{"program_Program", ",", "start_List", ",", "depth_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graph", "=", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", "visited", ",", "\[IndentingNewLine]", 
       "visit"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"visited", "[", "_", "]"}], "=", 
       RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"visit", "[", 
        RowBox[{"node_", ",", "d_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"visited", "[", "node", "]"}], "<", "d"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"visited", "[", "node", "]"}], "=", "d"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sow", "[", "node", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"d", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"visit", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"d", "-", "1"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"graph", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "node"}], "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"Except", "[", "0", "]"}], ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"visit", "[", 
            RowBox[{"#", ",", "depth"}], "]"}], "&"}], "/@", "start"}], "]"}],
         "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"4c2d4cab-a4e4-460e-a782-4967d25f2460"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CollectParents", "[", 
    RowBox[{"program_Program", ",", "start_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graph", "=", 
        RowBox[{"program", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", "visited", ",", "\[IndentingNewLine]", 
       "visit"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"visited", "[", "_", "]"}], "=", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"visit", "[", "node_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"visited", "[", "node", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"visited", "[", "node", "]"}], "=", "True"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sow", "[", "node", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"visit", "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "graph", "\[LeftDoubleBracket]", "node", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Except", "[", "0", "]"}], ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"visit", "[", "#", "]"}], "&"}], "/@", "start"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"8d0d7680-8ecc-4ac0-8d77-fcccf14b1b07"]
}, Closed]],

Cell[CellGroupData[{

Cell["Template", "Section",ExpressionUUID->"72d2315f-d117-470c-94b5-67b0e5072957"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "template", "=", 
   "\"\<\n//          Copyright Christian Volmer 2022, 2023.\n// Distributed \
under the Boost Software License, Version 1.0.\n//    (See accompanying file \
LICENSE_1_0.txt or copy at\n//          \
https://www.boost.org/LICENSE_1_0.txt)\n\n#include \\\"../standard_module.h\\\
\"\n\nnamespace offt {\nnamespace backend {\n\n/*\n\\tNumber of additions     \
  : <additionCount>\n\\tNumber of multiplications : <multiplicationCount>\n*/\
\n\ntemplate<> StandardModuleComplexity const StandardModule<float, \
<length>>::Complexity = { <additionCount>, <multiplicationCount> };\n\
template<> StandardModuleComplexity const StandardModule<double, \
<length>>::Complexity = { <additionCount>, <multiplicationCount> };\n\n\
template<typename valueT>\nstatic void ComputeCore(Phasors<valueT> const \
&phasors, valueT *pReal, valueT *pImag, ptrdiff_t stride, size_t \
twiddleStart, size_t twiddleIncrement)\n{\n\\t<temps>\n\n\\t<twiddle>\n\n\
\\t<computations>\n}\n\ntemplate<> void StandardModule<float, \
<length>>::Compute(float *pReal, float *pImag, ptrdiff_t stride, size_t \
twiddleStart, size_t twiddleIncrement) const\n{\n\\tComputeCore(mPhasors, \
pReal, pImag, stride, twiddleStart, twiddleIncrement);\n}\n\ntemplate<> void \
StandardModule<double, <length>>::Compute(double *pReal, double *pImag, \
ptrdiff_t stride, size_t twiddleStart, size_t twiddleIncrement) const\n{\n\
\\tComputeCore(mPhasors, pReal, pImag, stride, twiddleStart, \
twiddleIncrement);\n}\n\n}\n}\n\>\""}], ";"}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"0d48db77-fc10-4178-b6b4-db622dd2dce3"]
}, Closed]],

Cell[CellGroupData[{

Cell["General Code Generation", "Section",ExpressionUUID->"d0021630-26e0-46d5-bd31-c3037c93b876"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"TwiddleReal", ",", "TwiddleImag"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"TwiddleReal", ",", "TwiddleImag"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwiddleReal", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwiddleImag", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwiddleReal", "/:", 
   RowBox[{"Abs", "[", 
    RowBox[{"TwiddleReal", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"TwiddleReal", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwiddleImag", "/:", 
   RowBox[{"Abs", "[", 
    RowBox[{"TwiddleImag", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"TwiddleImag", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"TwiddleReal", ",", "TwiddleImag"}], "}"}], ",", "NHoldAll"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"TwiddleReal", ",", "TwiddleImag"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[180]:=",ExpressionUUID->"f693c632-5a78-47ce-9828-8777304c7ef6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coefficientToString", "[", "n_", "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegerQ", "[", "n", "]"}], "&&", 
      RowBox[{"n", "<", "0"}]}], ",", 
     RowBox[{"\"\<-\>\"", "<>", 
      RowBox[{"IntegerString", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IntegerQ", "[", "n", "]"}], "&&", 
      RowBox[{"n", ">=", "0"}]}], ",", 
     RowBox[{"IntegerString", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"n", ",", 
       RowBox[{"_TwiddleReal", "|", "_TwiddleImag"}]}], "]"}], ",", 
     RowBox[{"n", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"TwiddleReal", "[", "i_", "]"}], ":>", 
         RowBox[{"\"\<tw\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<r\>\""}]}], ",", 
        RowBox[{
         RowBox[{"TwiddleImag", "[", "i_", "]"}], ":>", 
         RowBox[{"\"\<tw\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<i\>\""}]}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
     RowBox[{"\"\<valueT(\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{"N", "[", 
         RowBox[{"n", ",", "20"}], "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}]}],
     "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[206]:=",ExpressionUUID->"26a38f1b-9851-46d4-b26e-bff9e17f1185"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"negativeCoefficientQ", "[", "coeff_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TrueQ", "[", 
     RowBox[{"coeff", "<", "0"}], "]"}], "||", 
    RowBox[{"MatchQ", "[", 
     RowBox[{"coeff", ",", 
      RowBox[{"-", "_TwiddleImag"}]}], "]"}], "||", 
    RowBox[{"MatchQ", "[", 
     RowBox[{"coeff", ",", 
      RowBox[{"-", "_TwiddleReal"}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[192]:=",ExpressionUUID->"7897187f-392e-46f1-b575-79c55dc3fc9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "rhsString", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rhsString", "[", 
     RowBox[{"varsIn_", ",", "coeffsIn_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "nonz", ",", "vars", ",", "coeffs", ",", "t", ",", "mults", ",", 
        "ops"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nonz", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"coeffsIn", ",", 
           RowBox[{"Except", "[", "0", "]"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{
        "varsIn", "\[LeftDoubleBracket]", "nonz", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"coeffs", "=", 
        RowBox[{
        "coeffsIn", "\[LeftDoubleBracket]", "nonz", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"coeffs", ",", "TwiddleReal"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{
             "coeffs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{"-", "_TwiddleImag"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"\"\<TwiddleReal(\>\"", "<>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "coeffs", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"_", "[", "i_", "]"}], ":>", 
                 RowBox[{"ToString", "[", "i", "]"}]}], "}"}]}], ")"}], "<>", 
             "\"\<)\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"\"\<TwiddleImag(\>\"", "<>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "coeffs", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"_", "[", "i_", "]"}], ":>", 
                 RowBox[{"ToString", "[", "i", "]"}]}], "}"}]}], ")"}], "<>", 
             "\"\<)\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "vars", "]"}], ">", "1"}], "&&", 
          RowBox[{"VectorQ", "[", 
           RowBox[{"coeffs", ",", "NumericQ"}], "]"}], "&&", 
          RowBox[{"Equal", "@@", 
           RowBox[{"Abs", "[", "coeffs", "]"}]}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
            "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "!=", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coefficientToString", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{
            "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "<>", "\"\< * (\>\"", "<>", 
          RowBox[{"rhsString", "[", 
           RowBox[{"vars", ",", 
            RowBox[{"coeffs", "/", 
             RowBox[{"Abs", "[", 
              RowBox[{
              "coeffs", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "]"}]}]}], "]"}], "<>", 
          "\"\<)\>\""}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mults", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"TrueQ", "[", 
                RowBox[{"#", "==", "1"}], "]"}], ",", "\"\<\>\"", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TrueQ", "[", 
                RowBox[{"#", "==", 
                 RowBox[{"-", "1"}]}], "]"}], ",", "\"\<\>\"", ",", 
               "\[IndentingNewLine]", "True", ",", 
               RowBox[{
                RowBox[{"coefficientToString", "[", 
                 RowBox[{"Abs", "[", "#", "]"}], "]"}], "<>", 
                "\"\< * \>\""}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
            "coeffs"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ops", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"negativeCoefficientQ", "[", "#", "]"}], ",", 
               "\"\< - \>\"", ",", "\"\< + \>\""}], "]"}], "&"}], "/@", 
            "coeffs"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "ops", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"negativeCoefficientQ", "[", 
              RowBox[{"First", "[", "coeffs", "]"}], "]"}], ",", "\"\<-\>\"", 
             ",", "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"ops", ",", " ", "mults", ",", "vars"}], "}"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assignmentString", "[", 
   RowBox[{"lhs_", ",", "rhs_", ",", "coeffs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lhsPosition", ",", "rhs2", ",", "coeffs2", ",", "ordering"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lhsPosition", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"rhs", ",", "lhs", ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "lhsPosition", "]"}], ">=", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lhsPosition", "=", 
         RowBox[{"lhsPosition", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rhs2", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"rhs", ",", "lhsPosition"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeffs2", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"coeffs", ",", "lhsPosition"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lhsPosition", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rhs", "]"}], "===", "1"}], "&&", 
        RowBox[{"lhsPosition", "===", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"lhs", "<>", "\"\< *= \>\"", "<>", 
        RowBox[{"coefficientToString", "[", 
         RowBox[{
         "coeffs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "<>", "\"\<;\>\""}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lhsPosition", ">", "0"}], "&&", 
        RowBox[{
         RowBox[{
         "coeffs", "\[LeftDoubleBracket]", "lhsPosition", 
          "\[RightDoubleBracket]"}], "==", "1"}], "&&", 
        RowBox[{
         RowBox[{"First", "[", "coeffs2", "]"}], ">=", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lhs", "<>", "\"\< += \>\"", "<>", 
        RowBox[{"rhsString", "[", 
         RowBox[{"rhs2", ",", "coeffs2"}], "]"}], "<>", "\"\<;\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lhsPosition", ">", "0"}], "&&", 
        RowBox[{
         RowBox[{
         "coeffs", "\[LeftDoubleBracket]", "lhsPosition", 
          "\[RightDoubleBracket]"}], "==", "1"}], "&&", 
        RowBox[{
         RowBox[{"First", "[", "coeffs2", "]"}], "<", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lhs", "<>", "\"\< -= \>\"", "<>", 
        RowBox[{"rhsString", "[", 
         RowBox[{"rhs2", ",", 
          RowBox[{"-", "coeffs2"}]}], "]"}], "<>", "\"\<;\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lhs", "<>", "\"\< = \>\"", "<>", 
        RowBox[{"rhsString", "[", 
         RowBox[{"rhs", ",", "coeffs"}], "]"}], "<>", "\"\<;\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[339]:=",ExpressionUUID->"2465f3b2-c679-44ed-89a0-7b1ca86b0c25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"variableDefinitionsString", "[", 
    RowBox[{"vars_", ",", "prefix_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"prefix", ",", "\"\< \>\"", ",", 
       RowBox[{"Riffle", "[", 
        RowBox[{"#", ",", "\"\<, \>\""}], "]"}], ",", "\"\<;\>\""}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{"vars", ",", 
      RowBox[{"UpTo", "[", "10", "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[172]:=",ExpressionUUID->"2859881b-8e33-4fdc-8d90-1e6a80a6c224"]
}, Closed]],

Cell[CellGroupData[{

Cell["Allocation Logic", "Section",ExpressionUUID->"d153db19-3126-4d85-b2a9-77c39781d465"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenerateComputationsAndTemps", "[", "prog_Program", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"source", "=", "prog"}], ",", "\[IndentingNewLine]", 
       RowBox[{"dest", "=", "prog"}], ",", "\[IndentingNewLine]", 
       "fixedVariables", ",", "\[IndentingNewLine]", "names", ",", 
       "\[IndentingNewLine]", "computations", ",", "\[IndentingNewLine]", 
       "temps"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dest", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Graph\>\"", ",", "All", ",", "All"}], 
        "\[RightDoubleBracket]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixedVariables", "=", 
       RowBox[{"2", 
        RowBox[{"source", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Length\>\""}], "\[RightDoubleBracket]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"names", "=", 
       RowBox[{
        RowBox[{"source", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Variables\>\""}], "\[RightDoubleBracket]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"InVar", "[", "i_", "]"}], ":>", 
           RowBox[{"\"\<x\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OutVar", "[", "i_", "]"}], ":>", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"EvenQ", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", "\"\<pReal[\>\"", ",", 
              "\"\<pImag[\>\""}], "]"}], "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "/", "2"}], "]"}], "]"}], 
            "<>", "\"\< * stride]\>\""}]}]}], "\[IndentingNewLine]", 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"tempPos", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"names", ",", 
             RowBox[{"_TempVar", "|", "_InVar"}]}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "names", "\[LeftDoubleBracket]", "tempPos", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\"\<t\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "tempPos", "]"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"computations", "=", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"While", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dest", ",", "source"}], "}"}], "=", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"length", "=", 
                 RowBox[{"source", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "\"\<Length\>\""}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"srcGraph", "=", 
                 RowBox[{"source", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "\"\<Graph\>\""}], 
                  "\[RightDoubleBracket]"}]}], ",", "srcAdj", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"variables", "=", 
                 RowBox[{"source", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "\"\<Variables\>\""}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"destGraph", "=", 
                 RowBox[{"dest", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "\"\<Graph\>\""}], 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "perm", ",", "\[IndentingNewLine]", "reserved", ",", "inputs",
                 ",", "\[IndentingNewLine]", "newVars", ",", "oldVars", ",", 
                "\[IndentingNewLine]", "localVars", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"indent", "=", "\"\<\>\""}]}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"reserved", "=", 
                RowBox[{"Range", "[", "fixedVariables", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"srcAdj", "=", 
                RowBox[{"Replace", "[", 
                 RowBox[{"srcGraph", ",", 
                  RowBox[{
                   RowBox[{"Except", "[", "0", "]"}], "->", "1"}], ",", 
                  RowBox[{"{", "2", "}"}], ",", 
                  RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"inputs", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Sign", "[", 
                    RowBox[{"Total", "[", "srcAdj", "]"}], "]"}], ",", "1"}], 
                  "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"inputs", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{"inputs", ",", "reserved"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"CollectChildren", "[", 
                 RowBox[{"source", ",", 
                  RowBox[{"inputs", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}], 
                  ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"CollectParents", "[", 
                 RowBox[{"source", ",", "perm"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"CollectChildren", "[", 
                 RowBox[{"source", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    "srcAdj", "\[LeftDoubleBracket]", "perm", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Heads", "->", "False"}]}], "]"}], "]"}], ",", 
                  "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"CollectParents", "[", 
                 RowBox[{"source", ",", "perm"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{"perm", ",", "reserved"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"newVars", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"reserved", ",", "perm"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"oldVars", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "srcGraph", "]"}], "]"}], ",", 
                  "newVars"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"perm", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"newVars", ",", "oldVars"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"srcGraph", "=", 
                RowBox[{"srcGraph", "\[LeftDoubleBracket]", 
                 RowBox[{"perm", ",", "perm"}], "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"srcAdj", "=", 
                RowBox[{"srcAdj", "\[LeftDoubleBracket]", 
                 RowBox[{"perm", ",", "perm"}], "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"variables", "=", 
                RowBox[{
                "variables", "\[LeftDoubleBracket]", "perm", 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"names", "=", 
                RowBox[{
                "names", "\[LeftDoubleBracket]", "perm", 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"destGraph", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"fixedVariables", "+", "1"}], ";;", 
                  RowBox[{"Length", "[", "newVars", "]"}]}], 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"srcGraph", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"fixedVariables", "+", "1"}], ";;", 
                  RowBox[{"Length", "[", "newVars", "]"}]}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"srcGraph", "\[LeftDoubleBracket]", 
                 RowBox[{";;", 
                  RowBox[{"Length", "[", "newVars", "]"}]}], 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"0", 
                 RowBox[{"srcGraph", "\[LeftDoubleBracket]", 
                  RowBox[{";;", 
                   RowBox[{"Length", "[", "newVars", "]"}]}], 
                  "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"srcAdj", "\[LeftDoubleBracket]", 
                 RowBox[{";;", 
                  RowBox[{"Length", "[", "newVars", "]"}]}], 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"0", 
                 RowBox[{"srcAdj", "\[LeftDoubleBracket]", 
                  RowBox[{";;", 
                   RowBox[{"Length", "[", "newVars", "]"}]}], 
                  "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"localVars", "=", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"fixedVariables", "+", "1"}], ",", 
                  RowBox[{"Length", "[", "newVars", "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"localVars", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{"localVars", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"Total", "[", "srcAdj", "]"}], "]"}], ",", "1"}], 
                    "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"localVars", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{"localVars", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"variables", ",", "_OutVar"}], "]"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "names", "\[LeftDoubleBracket]", "localVars", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\"\<s\>\"", "<>", 
                    RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ")"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "localVars", "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "localVars", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Sow", "[", "\"\<{\>\"", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"indent", "=", "\"\<\\t\>\""}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Sow", "/@", 
                   RowBox[{"variableDefinitionsString", "[", 
                    RowBox[{
                    RowBox[{
                    "names", "\[LeftDoubleBracket]", "localVars", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"indent", "<>", "\"\<valueT\>\""}]}], "]"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sow", "[", 
                   RowBox[{"StringJoin", "[", 
                    RowBox[{"indent", ",", 
                    RowBox[{"assignmentString", "[", 
                    RowBox[{
                    RowBox[{
                    "names", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "names", ",", 
                    RowBox[{
                    "destGraph", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "]"}], ";"}],
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"fixedVariables", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "newVars", "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "localVars", "]"}], ">", "0"}], ",", 
                 RowBox[{"Sow", "[", "\"\<}\>\"", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"fixedVariables", "=", 
                RowBox[{"Length", "[", "newVars", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Program", "[", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
                    RowBox[{"\"\<Graph\>\"", "->", "destGraph"}], ",", 
                    RowBox[{"\"\<Variables\>\"", "->", "variables"}]}], 
                   "|>"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Program", "[", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
                    RowBox[{"\"\<Graph\>\"", "->", "srcGraph"}], ",", 
                    RowBox[{"\"\<Variables\>\"", "->", "variables"}]}], 
                   "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"fixedVariables", "<", 
            RowBox[{"Length", "[", "names", "]"}]}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"temps", "=", 
       RowBox[{"variableDefinitionsString", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"names", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", "1"}], "]"}], "==", "\"\<x\>\""}], "||", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", "1"}], "]"}], "==", "\"\<t\>\""}]}], 
             "&"}]}], "]"}], "]"}], ",", "\"\<valueT\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"computations", ",", "temps"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[239]:=",ExpressionUUID->"e2d7f75c-ed5b-4b54-98de-f8312f862370"]
}, Closed]],

Cell[CellGroupData[{

Cell["Traditional C++ generation (twiddles at the beginning)", "Section",ExpressionUUID->"7fe7a0cb-8e56-4d77-8ae4-9001964df8c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GenerateCppCode", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateCppCode", "[", "length_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "prog", ",", "i", ",", "twiddle", ",", "computations", ",", "temps", ",",
       "additionCount", ",", "multiplicationCount"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Generating size \>\"", ",", "length"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramForLength", "[", "length", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramDeleteIdentities", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramMoveRight", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"computations", ",", "temps"}], "}"}], "=", 
      RowBox[{"GenerateComputationsAndTemps", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"twiddle", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<phasors.Multiply(\>\"", "<>", "\"\<x\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"2", "i"}], "+", "1"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<x\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"2", "i"}], "+", "2"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<pReal[\>\"", "<>", 
              RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
              "\"\< * stride]\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<pImag[\>\"", "<>", 
              RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
              "\"\< * stride]\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<twiddleStart + \>\"", "<>", 
              RowBox[{"IntegerString", "[", "i", "]"}], "<>", 
              "\"\< * twiddleIncrement);\>\""}]}], "\[IndentingNewLine]", 
            "}"}], ",", "\"\<, \>\""}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"length", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"additionCount", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"multiplicationCount", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"template", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<<length>\>\"", "->", 
          RowBox[{"IntegerString", "[", "length", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<<additionCount>\>\"", "->", 
          RowBox[{"IntegerString", "[", "additionCount", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<<multiplicationCount>\>\"", "->", 
          RowBox[{"IntegerString", "[", "multiplicationCount", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"w", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
           "\"\<<temps>\>\""}], ":>", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "temps"}], ",", 
             "\"\<\\n\>\""}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"w", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
           "\"\<<twiddle>\>\""}], ":>", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "twiddle"}], 
             ",", "\"\<\\n\>\""}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"w", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
           "\"\<<computations>\>\""}], ":>", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "computations"}],
              ",", "\"\<\\n\>\""}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[476]:=",ExpressionUUID->"0d3d3856-97ad-4bd1-ac92-2a8f52cdb271"],

Cell[BoxData[
 RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$ModulesTargetPath", ",", 
         RowBox[{"\"\<module_\>\"", "<>", 
          RowBox[{"IntegerString", "[", "length", "]"}], "<>", 
          "\"\<.cpp\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"GenerateCppCode", "[", "length", "]"}], ",", "\"\<Text\>\""}], 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"length", ",", 
     RowBox[{"Reverse", "@", 
      RowBox[{"Sort", "@", 
       RowBox[{"{", 
        RowBox[{
        "6", ",", "9", ",", "10", ",", "12", ",", "14", ",", "15", ",", "18", 
         ",", "19", ",", "20", ",", "21", ",", "22", ",", "24", ",", "25", 
         ",", "26", ",", "27", ",", "28", ",", "30"}], "}"}]}]}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "->", "\"\<FinestGrained\>\""}], ",", 
   RowBox[{"ProgressReporting", "->", "False"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[478]:=",ExpressionUUID->"5267d4db-87ab-4bbb-a068-ccc6c3885f0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["New C++ generation (defer twiddles)", "Section",ExpressionUUID->"2a88a4d3-13e9-4543-812d-20ee3d5dacda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComplexMultiplicationMatrix", "[", "z_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"RootReduce", "[", 
         RowBox[{"Re", "[", "z", "]"}], "]"}]}]}], ",", 
      RowBox[{"i", "=", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"RootReduce", "[", 
         RowBox[{"Im", "[", "z", "]"}], "]"}]}]}]}], "}"}], ",", 
    RowBox[{"(", GridBox[{
       {"r", 
        RowBox[{"-", "i"}]},
       {"i", "r"}
      }], ")"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[424]:=",ExpressionUUID->"aa74827c-e929-4545-b7a9-8fa69e2fa9d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProgramAddTwiddles", "[", "prog_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"tw", ",", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"prog", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Length\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"prog", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Graph\>\""}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"variables", "=", 
        RowBox[{"prog", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Variables\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tw", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"ReleaseHold", "@", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", "=", "i"}], "}"}], ",", 
              RowBox[{"Hold", "@", 
               RowBox[{"(", GridBox[{
                  {
                   RowBox[{"TwiddleReal", "[", "i", "]"}], 
                   RowBox[{"-", 
                    RowBox[{"TwiddleImag", "[", "i", "]"}]}]},
                  {
                   RowBox[{"TwiddleImag", "[", "i", "]"}], 
                   RowBox[{"TwiddleReal", "[", "i", "]"}]}
                 }], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"length", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", "length"}], ",", 
                RowBox[{"2", "length"}]}], "}"}]}], "]"}], ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "graph"}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graph", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"2", "length"}], "+", "1"}], ";;", 
          RowBox[{"4", "length"}]}], ",", 
         RowBox[{";;", 
          RowBox[{"2", "length"}]}]}], "\[RightDoubleBracket]"}], "=", "tw"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"variables", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"variables", "\[LeftDoubleBracket]", 
          RowBox[{";;", 
           RowBox[{"2", "length"}]}], "\[RightDoubleBracket]"}], ",", 
         "variables"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"variables", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "length"}], "+", "1"}], ";;", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "length"}], "-", "1"}]}], 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{"Array", "[", 
        RowBox[{"TempVar", ",", 
         RowBox[{
          RowBox[{"Length", "[", "variables", "]"}], "-", 
          RowBox[{"4", "length"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Program", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Length\>\"", "->", "length"}], ",", 
         RowBox[{"\"\<Graph\>\"", "->", "graph"}], ",", 
         RowBox[{"\"\<Variables\>\"", "->", "variables"}]}], "|>"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[425]:=",ExpressionUUID->"0f43659a-af6e-4087-89fc-ad4d144e6993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GenerateCppCode", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateCppCode", "[", "length_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "prog", ",", "i", ",", "twiddle", ",", "computations", ",", "temps", ",",
       "additionCount", ",", "multiplicationCount", ",", "code"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Generating size \>\"", ",", "length"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramForLength", "[", "length", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramDeleteIdentities", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramAddTwiddles", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prog", "=", 
      RowBox[{"ProgramMoveRight", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"computations", ",", "temps"}], "}"}], "=", 
      RowBox[{"GenerateComputationsAndTemps", "[", "prog", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"\"\<x\>\"", "~~", 
            RowBox[{"DigitCharacter", ".."}], "~~", "\"\<, \>\""}], "->", 
           "\"\<\>\""}]}], "]"}], "&"}], "/@", "temps"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"\"\<, x\>\"", "~~", 
            RowBox[{"DigitCharacter", ".."}]}], "->", "\"\<\>\""}]}], "]"}], 
        "&"}], "/@", "temps"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temps", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"\"\<valueT x\>\"", "~~", 
            RowBox[{"DigitCharacter", ".."}], "~~", "\"\<;\>\""}], "->", 
           "\"\<\>\""}]}], "]"}], "&"}], "/@", "temps"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"twiddle", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"additionCount", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"multiplicationCount", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"code", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"template", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<<length>\>\"", "->", 
           RowBox[{"IntegerString", "[", "length", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<<additionCount>\>\"", "->", 
           RowBox[{"IntegerString", "[", "additionCount", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<<multiplicationCount>\>\"", "->", 
           RowBox[{"IntegerString", "[", "multiplicationCount", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<temps>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "temps"}], ",", 
              "\"\<\\n\>\""}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<twiddle>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", "twiddle"}], 
              ",", "\"\<\\n\>\""}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"w", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<\\t\>\"", ".."}], ")"}]}], "~~", 
            "\"\<<computations>\>\""}], ":>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringJoin", "[", 
                 RowBox[{"w", ",", "#"}], "]"}], "&"}], "/@", 
               "computations"}], ",", "\"\<\\n\>\""}], "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"code", ",", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"varI", ":", 
            RowBox[{"(", 
             RowBox[{"WordCharacter", ".."}], ")"}]}], "~~", 
           "\"\< = TwiddleImag(\>\"", "~~", 
           RowBox[{"index", ":", 
            RowBox[{"(", 
             RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", "\"\<);\>\"", "~~",
            "Whitespace", "~~", "\[IndentingNewLine]", 
           RowBox[{"varR", ":", 
            RowBox[{"(", 
             RowBox[{"WordCharacter", ".."}], ")"}]}], "~~", 
           "\"\< = TwiddleReal(\>\"", "~~", 
           RowBox[{"index2", ":", 
            RowBox[{"(", 
             RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", "\"\<);\>\""}], 
          ":>", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<phasors.Multiply(\>\"", "<>", "\[IndentingNewLine]", "varR", 
           "<>", "\"\<, \>\"", "<>", "\[IndentingNewLine]", "varI", "<>", 
           "\"\<, \>\"", "<>", "\[IndentingNewLine]", "\"\<pReal[\>\"", "<>", 
           "index", "<>", "\"\< * stride], \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<pImag[\>\"", "<>", "index", "<>", 
           "\"\< * stride], twiddleStart + \>\"", "<>", "\[IndentingNewLine]",
            "index", "<>", "\"\< * twiddleIncrement);\>\""}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"varR", ":", 
            RowBox[{"(", 
             RowBox[{"WordCharacter", ".."}], ")"}]}], "~~", 
           "\"\< = TwiddleReal(\>\"", "~~", 
           RowBox[{"index", ":", 
            RowBox[{"(", 
             RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", "\"\<);\>\"", "~~",
            "Whitespace", "~~", "\[IndentingNewLine]", 
           RowBox[{"varI", ":", 
            RowBox[{"(", 
             RowBox[{"WordCharacter", ".."}], ")"}]}], "~~", 
           "\"\< = TwiddleImag(\>\"", "~~", 
           RowBox[{"index2", ":", 
            RowBox[{"(", 
             RowBox[{"DigitCharacter", ".."}], ")"}]}], "~~", "\"\<);\>\""}], 
          ":>", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<phasors.Multiply(\>\"", "<>", "\[IndentingNewLine]", "varR", 
           "<>", "\"\<, \>\"", "<>", "\[IndentingNewLine]", "varI", "<>", 
           "\"\<, \>\"", "<>", "\[IndentingNewLine]", "\"\<pReal[\>\"", "<>", 
           "index", "<>", "\"\< * stride], \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<pImag[\>\"", "<>", "index", "<>", 
           "\"\< * stride], twiddleStart + \>\"", "<>", "\[IndentingNewLine]",
            "index", "<>", "\"\< * twiddleIncrement);\>\""}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[479]:=",ExpressionUUID->"24563a18-081e-42d0-95dc-ba34249bea24"],

Cell[BoxData[
 RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$ModulesTargetPath", ",", 
         RowBox[{"\"\<module_\>\"", "<>", 
          RowBox[{"IntegerString", "[", "length", "]"}], "<>", 
          "\"\<.cpp\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"GenerateCppCode", "[", "length", "]"}], ",", "\"\<Text\>\""}], 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"length", ",", 
     RowBox[{"Reverse", "@", 
      RowBox[{"Sort", "@", 
       RowBox[{"{", "3", "}"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "->", "\"\<FinestGrained\>\""}], ",", 
   RowBox[{"ProgressReporting", "->", "False"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[481]:=",ExpressionUUID->"c35ec50e-4f1d-4ce9-b6a5-b10496f1cbc3"]
}, Closed]]
},
WindowSize->{1350, 677},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8ecd3760-f647-4284-96f4-073318234348"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 375, 10, 29, "Input",ExpressionUUID->"623eb154-4eb0-47a7-9f6c-1d131fc34155"],
Cell[936, 32, 390, 10, 50, "Input",ExpressionUUID->"d3f85e32-929e-4463-8351-083d39e94f66"],
Cell[1329, 44, 321, 8, 29, "Input",ExpressionUUID->"73f4855c-af29-4fb0-ba6e-2fd2b19fef39"],
Cell[CellGroupData[{
Cell[1675, 56, 82, 0, 67, "Section",ExpressionUUID->"2e5cf9ae-f3de-4901-a2e5-a392c5a535e7"],
Cell[CellGroupData[{
Cell[1782, 60, 83, 0, 54, "Subsection",ExpressionUUID->"a8e26c4e-d241-4d7e-af60-f30958993008"],
Cell[1868, 62, 858, 23, 90, "Input",ExpressionUUID->"a6ef962d-fb68-41b3-9b78-f924bb7ea931"]
}, Closed]],
Cell[CellGroupData[{
Cell[2763, 90, 93, 0, 54, "Subsection",ExpressionUUID->"834b30df-0b91-4bda-bc3e-50dbbb6ab82f"],
Cell[2859, 92, 3244, 82, 410, "Input",ExpressionUUID->"bc046129-b35b-48f2-a465-04c8c2fdf438"]
}, Closed]],
Cell[CellGroupData[{
Cell[6140, 179, 87, 0, 54, "Subsection",ExpressionUUID->"c7a5add4-3778-45e9-8db2-918dd6a182d5"],
Cell[6230, 181, 3238, 80, 510, "Input",ExpressionUUID->"245ee954-ce98-49f0-bd4f-0d50e5f056b5"]
}, Closed]],
Cell[CellGroupData[{
Cell[9505, 266, 92, 0, 54, "Subsection",ExpressionUUID->"3f4b3124-271e-4d90-a8cc-9c2b0370b7b9"],
Cell[9600, 268, 1127, 33, 70, "Input",ExpressionUUID->"7364f4e8-7abb-4e68-99a6-9b3a7169641f"]
}, Closed]],
Cell[CellGroupData[{
Cell[10764, 306, 88, 0, 54, "Subsection",ExpressionUUID->"b35eb0f9-2459-4fca-9384-04a6fc622a19"],
Cell[10855, 308, 1917, 51, 90, "Input",ExpressionUUID->"97dacd3f-54a4-4d81-8dbf-3bcf0aa9a790"]
}, Closed]],
Cell[CellGroupData[{
Cell[12809, 364, 93, 0, 54, "Subsection",ExpressionUUID->"67bf655c-d309-447a-8229-06da12c6db96"],
Cell[12905, 366, 3857, 86, 530, "Input",ExpressionUUID->"2bbdf6cc-04ac-4fa2-82c8-6a3074864b86"]
}, Closed]],
Cell[CellGroupData[{
Cell[16799, 457, 100, 0, 54, "Subsection",ExpressionUUID->"4580373f-701d-4005-9644-bd2840b42706"],
Cell[16902, 459, 5513, 128, 530, "Input",ExpressionUUID->"98bade53-8459-490f-b2d7-bbbb90d1dbe0"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[22464, 593, 83, 0, 53, "Section",ExpressionUUID->"3d73821e-1c28-42b2-82d8-a87bc1de86f3"],
Cell[22550, 595, 2581, 63, 350, "Input",ExpressionUUID->"4c2d4cab-a4e4-460e-a782-4967d25f2460"],
Cell[25134, 660, 2083, 51, 310, "Input",ExpressionUUID->"8d0d7680-8ecc-4ac0-8d77-fcccf14b1b07"]
}, Closed]],
Cell[CellGroupData[{
Cell[27254, 716, 82, 0, 53, "Section",ExpressionUUID->"72d2315f-d117-470c-94b5-67b0e5072957"],
Cell[27339, 718, 1632, 25, 850, "Input",ExpressionUUID->"0d48db77-fc10-4178-b6b4-db622dd2dce3"]
}, Closed]],
Cell[CellGroupData[{
Cell[29008, 748, 97, 0, 53, "Section",ExpressionUUID->"d0021630-26e0-46d5-bd31-c3037c93b876"],
Cell[29108, 750, 1289, 37, 170, "Input",ExpressionUUID->"f693c632-5a78-47ce-9828-8777304c7ef6"],
Cell[30400, 789, 1486, 37, 110, "Input",ExpressionUUID->"26a38f1b-9851-46d4-b26e-bff9e17f1185"],
Cell[31889, 828, 500, 14, 29, "Input",ExpressionUUID->"7897187f-392e-46f1-b575-79c55dc3fc9f"],
Cell[32392, 844, 9427, 225, 1170, "Input",ExpressionUUID->"2465f3b2-c679-44ed-89a0-7b1ca86b0c25"],
Cell[41822, 1071, 577, 16, 29, "Input",ExpressionUUID->"2859881b-8e33-4fdc-8d90-1e6a80a6c224"]
}, Closed]],
Cell[CellGroupData[{
Cell[42436, 1092, 90, 0, 53, "Section",ExpressionUUID->"d153db19-3126-4d85-b2a9-77c39781d465"],
Cell[42529, 1094, 16857, 352, 1870, "Input",ExpressionUUID->"e2d7f75c-ed5b-4b54-98de-f8312f862370"]
}, Closed]],
Cell[CellGroupData[{
Cell[59423, 1451, 128, 0, 53, "Section",ExpressionUUID->"7fe7a0cb-8e56-4d77-8ae4-9001964df8c9"],
Cell[59554, 1453, 5247, 123, 670, "Input",ExpressionUUID->"0d3d3856-97ad-4bd1-ac92-2a8f52cdb271"],
Cell[64804, 1578, 1179, 28, 130, "Input",ExpressionUUID->"5267d4db-87ab-4bbb-a068-ccc6c3885f0d"]
}, Closed]],
Cell[CellGroupData[{
Cell[66020, 1611, 109, 0, 53, "Section",ExpressionUUID->"2a88a4d3-13e9-4543-812d-20ee3d5dacda"],
Cell[66132, 1613, 687, 21, 47, "Input",ExpressionUUID->"aa74827c-e929-4545-b7a9-8fa69e2fa9d6"],
Cell[66822, 1636, 3974, 102, 343, "Input",ExpressionUUID->"0f43659a-af6e-4087-89fc-ad4d144e6993"],
Cell[70799, 1740, 8060, 188, 1070, "Input",ExpressionUUID->"24563a18-081e-42d0-95dc-ba34249bea24"],
Cell[78862, 1930, 952, 23, 130, "Input",ExpressionUUID->"c35ec50e-4f1d-4ce9-b6a5-b10496f1cbc3"]
}, Closed]]
}
]
*)

